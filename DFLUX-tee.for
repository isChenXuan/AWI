C=====================================================================
C          This subroutine is generated by ABAQUS weld plugin        C
C                 on 2024-06-05 16:04:20                             C       
C                    CopyRight © 2024 ChenXuan                       C
C                   Email: isChenXuan@outlook.com                    C
C            本子程序用于生成沿任意空间曲线运动的热源函数.           C
C=====================================================================
      INCLUDE 'MODULES.INC'                                           
      SUBROUTINE DFLUX(FLUX,SOL,KSTEP,KINC,TIME,NOEL,NPT,COORDS,JLTYP,
     1TEMP,PRESS,SNAME)                                               
      USE WELDMATH                                                    
      INCLUDE 'ABA_PARAM.INC'                                         
      DIMENSION COORDS(3),FLUX(2),TIME(2)                             
      CHARACTER*80 SNAME                                              
C   以上声明除INCLUDE 'MODULES.INC'及USE WELDMATH外,均为ABAQUS设置的接
C   口参数,修改就会报错,勿动!!!                                       
                                                                      
C   以下为用户变量声明                                                
C   焊接工艺参数                                                      
      ! WI：焊接电流,安培                                             
      ! WU：焊接电压,伏特                                             
      ! YI：焊接热效率,<1.0                                           
      ! VE：焊接线速度,毫米/秒                                        
      REAL :: WI, WU, YI, VE                                          
                                                                      
C   双椭球热源参数                                                    
      ! a1  ：热源前进方向椭球半轴长,毫米,建议a1=b=0.45*焊缝宽度      
      ! a2  ：热源后方方向椭球半轴长,毫米,建议a2=2a1                  
      ! b   ：焊缝宽度方向椭球半轴长,毫米,建议a1=b=0.45*焊缝宽度      
      ! c   ：焊缝深度方向椭球半轴长,毫米,建议c=0.90*焊缝深度         
      ! POWR：输入功率,毫瓦                                           
      ! f1  ：前半椭球能量系数,f1+f2=2,f1/f2=a1/a2                    
      ! f2  ：后半椭球能量系数                                        
      ! qm1 ：前半椭球能量峰值                                        
      ! qm2 ：后半椭球能量峰值                                        
      REAL :: a1, a2, b, c, POWR, f1, f2, qm1, qm2                    
                                                                      
C   坐标计算                                                          
      ! P1  : 焊接点                                                  
      ! P2  : 焊接前进点                                              
      ! P3  : 焊趾点                                                  
      ! DIS ：点到热源面的距离                                        
      REAL :: P1(3), P2(3), P3(3)                                     
      REAL :: DIS(3)                                                  
                                                                      
C   接口参数                                                          
      ! TCLD：本条焊缝开始之前的累积消耗时间,需要覆盖本条焊缝之前的所 
      !       有焊接及非焊接时间.                                     
      ! TCRT：本条焊缝已焊接时间,TCRT=TIME(2)-TCLD,若本条焊缝在一个   
      !       STEP内完成,则TCRT=TIME(1).                              
      ! PA  ：任意空间点坐标,即ABAQUS接口中的COORDS,由于COORDS参数无  
      !       REAL修饰,直接调用会报错.                                
      REAL :: TCLD, TCRT, PA(3)                                       
                                                                      
C  ========================第1条焊缝开始============================                                      
      IF (KSTEP >= 2 .AND. KSTEP <= 17) THEN                                  
C  焊接参数设置                                                                                                          
          WI = 300.0                                                                             
          WU = 9.5                                                                             
          YI = 0.9                                                                                
          VE = 3.9                                                                             
C  双椭球热源参数设置                                                                                                    
          ! 输入值                                                                                                       
          a1 = 1.62                                                                                      
          a2 = 3.24                                                                                      
          b  = 1.62                                                                                       
          c  = 0.77                                                                                       
          qm1  = 1579271.55149                                                                                   
          qm2  = 1579271.55149                                                                                   
C  计算坐标                                                                                                              
          TCRT = TIME(2) - 1e-07                                                                               
          IF (TCRT <= 0.4072) THEN                                                 
              XW = 0.0123*(TCRT-0.0)**3+-0.4663*(TCRT-0.0)**2+0.0015*(TCRT-0.0)+15.6921                                                                                    
              YW = -0.0328*(TCRT-0.0)**3+0.4138*(TCRT-0.0)**2+-0.0042*(TCRT-0.0)+20.5437                                                                                    
              ZW = 0.0541*(TCRT-0.0)**3+0.0072*(TCRT-0.0)**2+-3.9042*(TCRT-0.0)+0.0                                                                                    
              XF = XW+0.0123*3*(TCRT-0.0)**2+-0.4663*2*(TCRT-0.0)+0.0015                                                                                 
              YF = YW+-0.0328*3*(TCRT-0.0)**2+0.4138*2*(TCRT-0.0)+-0.0042                                                                                 
              ZF = ZW+0.0541*3*(TCRT-0.0)**2+0.0072*2*(TCRT-0.0)+-3.9042                                                                                 
              XT = -0.0618*(TCRT-0.0)**3+-0.3253*(TCRT-0.0)**2+-0.037*(TCRT-0.0)+15.0                                                                                    
              YT = 0.0275*(TCRT-0.0)**3+0.2862*(TCRT-0.0)**2+0.0269*(TCRT-0.0)+22.0                                                                                    
              ZT = -0.4169*(TCRT-0.0)**3+0.7466*(TCRT-0.0)**2+-3.8685*(TCRT-0.0)+0.0                                                                                    
          ELSEIF (TCRT <= 0.8141) THEN                                             
              XW = 0.0127*(TCRT-0.4072)**3+-0.4512*(TCRT-0.4072)**2+-0.3721*(TCRT-0.4072)+15.6162                                                                                    
              YW = -0.0331*(TCRT-0.4072)**3+0.3738*(TCRT-0.4072)**2+0.3166*(TCRT-0.4072)+20.6084                                                                                    
              ZW = 0.0541*(TCRT-0.4072)**3+0.0733*(TCRT-0.4072)**2+-3.8714*(TCRT-0.4072)+-1.5851                                                                                    
              XF = XW+0.0127*3*(TCRT-0.4072)**2+-0.4512*2*(TCRT-0.4072)+-0.3721                                                                                 
              YF = YW+-0.0331*3*(TCRT-0.4072)**2+0.3738*2*(TCRT-0.4072)+0.3166                                                                                 
              ZF = ZW+0.0541*3*(TCRT-0.4072)**2+0.0733*2*(TCRT-0.4072)+-3.8714                                                                                 
              XT = -0.0615*(TCRT-0.4072)**3+-0.4007*(TCRT-0.4072)**2+-0.3326*(TCRT-0.4072)+14.9268                                                                                    
              YT = 0.0272*(TCRT-0.4072)**3+0.3198*(TCRT-0.4072)**2+0.2737*(TCRT-0.4072)+22.0603                                                                                    
              ZT = -0.4175*(TCRT-0.4072)**3+0.2373*(TCRT-0.4072)**2+-3.4678*(TCRT-0.4072)+-1.4797                                                                                    
          ELSEIF (TCRT <= 1.2203) THEN                                             
              XW = 0.0192*(TCRT-0.8141)**3+-0.4358*(TCRT-0.8141)**2+-0.733*(TCRT-0.8141)+15.391                                                                                    
              YW = -0.0532*(TCRT-0.8141)**3+0.3334*(TCRT-0.8141)**2+0.6043*(TCRT-0.8141)+20.7969                                                                                    
              ZW = 0.0379*(TCRT-0.8141)**3+0.1394*(TCRT-0.8141)**2+-3.7849*(TCRT-0.8141)+-3.1443                                                                                    
              XF = XW+0.0192*3*(TCRT-0.8141)**2+-0.4358*2*(TCRT-0.8141)+-0.733                                                                                 
              YF = YW+-0.0532*3*(TCRT-0.8141)**2+0.3334*2*(TCRT-0.8141)+0.6043                                                                                 
              ZF = ZW+0.0379*3*(TCRT-0.8141)**2+0.1394*2*(TCRT-0.8141)+-3.7849                                                                                 
              XT = 0.108*(TCRT-0.8141)**3+-0.4758*(TCRT-0.8141)**2+-0.6892*(TCRT-0.8141)+14.721                                                                                    
              YT = -0.1223*(TCRT-0.8141)**3+0.353*(TCRT-0.8141)**2+0.5474*(TCRT-0.8141)+22.2264                                                                                    
              ZT = 0.5449*(TCRT-0.8141)**3+-0.2722*(TCRT-0.8141)**2+-3.482*(TCRT-0.8141)+-2.8794                                                                                    
          ELSEIF (TCRT <= 1.6263) THEN                                             
              XW = 0.0186*(TCRT-1.2203)**3+-0.4124*(TCRT-1.2203)**2+-1.0775*(TCRT-1.2203)+15.0227                                                                                    
              YW = -0.0557*(TCRT-1.2203)**3+0.2686*(TCRT-1.2203)**2+0.8489*(TCRT-1.2203)+21.0938                                                                                    
              ZW = 0.0264*(TCRT-1.2203)**3+0.1856*(TCRT-1.2203)**2+-3.6529*(TCRT-1.2203)+-4.6562                                                                                    
              XF = XW+0.0186*3*(TCRT-1.2203)**2+-0.4124*2*(TCRT-1.2203)+-1.0775                                                                                 
              YF = YW+-0.0557*3*(TCRT-1.2203)**2+0.2686*2*(TCRT-1.2203)+0.8489                                                                                 
              ZF = ZW+0.0264*3*(TCRT-1.2203)**2+0.1856*2*(TCRT-1.2203)+-3.6529                                                                                 
              XT = 0.0027*(TCRT-1.2203)**3+-0.3442*(TCRT-1.2203)**2+-1.0223*(TCRT-1.2203)+14.3698                                                                                    
              YT = -0.0352*(TCRT-1.2203)**3+0.2041*(TCRT-1.2203)**2+0.7737*(TCRT-1.2203)+22.4988                                                                                    
              ZT = -0.1669*(TCRT-1.2203)**3+0.3918*(TCRT-1.2203)**2+-3.4334*(TCRT-1.2203)+-4.3021                                                                                    
          ELSEIF (TCRT <= 2.0381) THEN                                             
              XW = 0.0166*(TCRT-1.6263)**3+-0.3897*(TCRT-1.6263)**2+-1.4031*(TCRT-1.6263)+14.5185                                                                                    
              YW = -0.0544*(TCRT-1.6263)**3+0.2007*(TCRT-1.6263)**2+1.0394*(TCRT-1.6263)+21.479                                                                                    
              ZW = 0.0185*(TCRT-1.6263)**3+0.2177*(TCRT-1.6263)**2+-3.4892*(TCRT-1.6263)+-6.1069                                                                                    
              XF = XW+0.0166*3*(TCRT-1.6263)**2+-0.3897*2*(TCRT-1.6263)+-1.4031                                                                                 
              YF = YW+-0.0544*3*(TCRT-1.6263)**2+0.2007*2*(TCRT-1.6263)+1.0394                                                                                 
              ZF = ZW+0.0185*3*(TCRT-1.6263)**2+0.2177*2*(TCRT-1.6263)+-3.4892                                                                                 
              XT = -0.0219*(TCRT-1.6263)**3+-0.3409*(TCRT-1.6263)**2+-1.3005*(TCRT-1.6263)+13.8982                                                                                    
              YT = -0.0227*(TCRT-1.6263)**3+0.1612*(TCRT-1.6263)**2+0.922*(TCRT-1.6263)+22.8442                                                                                    
              ZT = -0.031*(TCRT-1.6263)**3+0.1886*(TCRT-1.6263)**2+-3.1978*(TCRT-1.6263)+-5.6427                                                                                    
          ELSEIF (TCRT <= 2.4456) THEN                                             
              XW = 0.0138*(TCRT-2.0381)**3+-0.3692*(TCRT-2.0381)**2+-1.7157*(TCRT-2.0381)+13.8757                                                                                    
              YW = -0.0501*(TCRT-2.0381)**3+0.1335*(TCRT-2.0381)**2+1.1771*(TCRT-2.0381)+21.9373                                                                                    
              ZW = 0.0147*(TCRT-2.0381)**3+0.2406*(TCRT-2.0381)**2+-3.3004*(TCRT-2.0381)+-7.5057                                                                                    
              XF = XW+0.0138*3*(TCRT-2.0381)**2+-0.3692*2*(TCRT-2.0381)+-1.7157                                                                                 
              YF = YW+-0.0501*3*(TCRT-2.0381)**2+0.1335*2*(TCRT-2.0381)+1.1771                                                                                 
              ZF = ZW+0.0147*3*(TCRT-2.0381)**2+0.2406*2*(TCRT-2.0381)+-3.3004                                                                                 
              XT = 0.0145*(TCRT-2.0381)**3+-0.368*(TCRT-2.0381)**2+-1.5924*(TCRT-2.0381)+13.3033                                                                                    
              YT = -0.0529*(TCRT-2.0381)**3+0.1331*(TCRT-2.0381)**2+1.0432*(TCRT-2.0381)+23.2497                                                                                    
              ZT = 0.051*(TCRT-2.0381)**3+0.1503*(TCRT-2.0381)**2+-3.0582*(TCRT-2.0381)+-6.9299                                                                                    
          ELSEIF (TCRT <= 2.8537) THEN                                             
              XW = 0.0119*(TCRT-2.4456)**3+-0.3524*(TCRT-2.4456)**2+-2.0098*(TCRT-2.4456)+13.1161                                                                                    
              YW = -0.0457*(TCRT-2.4456)**3+0.0723*(TCRT-2.4456)**2+1.261*(TCRT-2.4456)+22.4358                                                                                    
              ZW = 0.0145*(TCRT-2.4456)**3+0.2585*(TCRT-2.4456)**2+-3.097*(TCRT-2.4456)+-8.8097                                                                                    
              XF = XW+0.0119*3*(TCRT-2.4456)**2+-0.3524*2*(TCRT-2.4456)+-2.0098                                                                                 
              YF = YW+-0.0457*3*(TCRT-2.4456)**2+0.0723*2*(TCRT-2.4456)+1.261                                                                                 
              ZF = ZW+0.0145*3*(TCRT-2.4456)**2+0.2585*2*(TCRT-2.4456)+-3.097                                                                                 
              XT = 0.1554*(TCRT-2.4456)**3+-0.3502*(TCRT-2.4456)**2+-1.885*(TCRT-2.4456)+12.5943                                                                                    
              YT = -0.1057*(TCRT-2.4456)**3+0.0685*(TCRT-2.4456)**2+1.1254*(TCRT-2.4456)+23.6933                                                                                    
              ZT = 0.1523*(TCRT-2.4456)**3+0.2126*(TCRT-2.4456)**2+-2.9103*(TCRT-2.4456)+-8.1477                                                                                    
          ELSEIF (TCRT <= 3.2627) THEN                                             
              XW = 0.0114*(TCRT-2.8537)**3+-0.3378*(TCRT-2.8537)**2+-2.2914*(TCRT-2.8537)+12.238                                                                                    
              YW = -0.042*(TCRT-2.8537)**3+0.0163*(TCRT-2.8537)**2+1.2972*(TCRT-2.8537)+22.9593                                                                                    
              ZW = 0.0162*(TCRT-2.8537)**3+0.2763*(TCRT-2.8537)**2+-2.8788*(TCRT-2.8537)+-10.0296                                                                                    
              XF = XW+0.0114*3*(TCRT-2.8537)**2+-0.3378*2*(TCRT-2.8537)+-2.2914                                                                                 
              YF = YW+-0.042*3*(TCRT-2.8537)**2+0.0163*2*(TCRT-2.8537)+1.2972                                                                                 
              ZF = ZW+0.0162*3*(TCRT-2.8537)**2+0.2763*2*(TCRT-2.8537)+-2.8788                                                                                 
              XT = -0.3126*(TCRT-2.8537)**3+-0.1599*(TCRT-2.8537)**2+-2.0932*(TCRT-2.8537)+11.7772                                                                                    
              YT = 0.1205*(TCRT-2.8537)**3+-0.0609*(TCRT-2.8537)**2+1.1285*(TCRT-2.8537)+24.1568                                                                                    
              ZT = -0.3255*(TCRT-2.8537)**3+0.399*(TCRT-2.8537)**2+-2.6607*(TCRT-2.8537)+-9.2897                                                                                    
          ELSEIF (TCRT <= 3.6725) THEN                                             
              XW = 0.0127*(TCRT-3.2627)**3+-0.3238*(TCRT-3.2627)**2+-2.562*(TCRT-3.2627)+11.2451                                                                                    
              YW = -0.0392*(TCRT-3.2627)**3+-0.0352*(TCRT-3.2627)**2+1.2895*(TCRT-3.2627)+23.4897                                                                                    
              ZW = 0.0189*(TCRT-3.2627)**3+0.2961*(TCRT-3.2627)**2+-2.6447*(TCRT-3.2627)+-11.1597                                                                                    
              XF = XW+0.0127*3*(TCRT-3.2627)**2+-0.3238*2*(TCRT-3.2627)+-2.562                                                                                 
              YF = YW+-0.0392*3*(TCRT-3.2627)**2+-0.0352*2*(TCRT-3.2627)+1.2895                                                                                 
              ZF = ZW+0.0189*3*(TCRT-3.2627)**2+0.2961*2*(TCRT-3.2627)+-2.6447                                                                                 
              XT = 0.2364*(TCRT-3.2627)**3+-0.5435*(TCRT-3.2627)**2+-2.3809*(TCRT-3.2627)+10.873                                                                                    
              YT = -0.1539*(TCRT-3.2627)**3+0.0869*(TCRT-3.2627)**2+1.1391*(TCRT-3.2627)+24.6164                                                                                    
              ZT = 0.2932*(TCRT-3.2627)**3+-0.0004*(TCRT-3.2627)**2+-2.4976*(TCRT-3.2627)+-10.3334                                                                                    
          ELSEIF (TCRT <= 4.0831) THEN                                             
              XW = 0.0159*(TCRT-3.6725)**3+-0.3081*(TCRT-3.6725)**2+-2.8209*(TCRT-3.6725)+10.1418                                                                                    
              YW = -0.0368*(TCRT-3.6725)**3+-0.0833*(TCRT-3.6725)**2+1.2409*(TCRT-3.6725)+24.0095                                                                                    
              ZW = 0.0218*(TCRT-3.6725)**3+0.3193*(TCRT-3.6725)**2+-2.3925*(TCRT-3.6725)+-12.1924                                                                                    
              XF = XW+0.0159*3*(TCRT-3.6725)**2+-0.3081*2*(TCRT-3.6725)+-2.8209                                                                                 
              YF = YW+-0.0368*3*(TCRT-3.6725)**2+-0.0833*2*(TCRT-3.6725)+1.2409                                                                                 
              ZF = ZW+0.0218*3*(TCRT-3.6725)**2+0.3193*2*(TCRT-3.6725)+-2.3925                                                                                 
              XT = -0.0505*(TCRT-3.6725)**3+-0.2528*(TCRT-3.6725)**2+-2.7072*(TCRT-3.6725)+9.8223                                                                                    
              YT = -0.0017*(TCRT-3.6725)**3+-0.1023*(TCRT-3.6725)**2+1.1327*(TCRT-3.6725)+25.0872                                                                                    
              ZT = -0.0477*(TCRT-3.6725)**3+0.3601*(TCRT-3.6725)**2+-2.3502*(TCRT-3.6725)+-11.3367                                                                                    
          ELSEIF (TCRT <= 4.4944) THEN                                             
              XW = 0.0211*(TCRT-4.0831)**3+-0.2885*(TCRT-4.0831)**2+-3.0659*(TCRT-4.0831)+8.9327                                                                                    
              YW = -0.0346*(TCRT-4.0831)**3+-0.1287*(TCRT-4.0831)**2+1.1538*(TCRT-4.0831)+24.5024                                                                                    
              ZW = 0.0239*(TCRT-4.0831)**3+0.3461*(TCRT-4.0831)**2+-2.1193*(TCRT-4.0831)+-13.1194                                                                                    
              XF = XW+0.0211*3*(TCRT-4.0831)**2+-0.2885*2*(TCRT-4.0831)+-3.0659                                                                                 
              YF = YW+-0.0346*3*(TCRT-4.0831)**2+-0.1287*2*(TCRT-4.0831)+1.1538                                                                                 
              ZF = ZW+0.0239*3*(TCRT-4.0831)**2+0.3461*2*(TCRT-4.0831)+-2.1193                                                                                 
              XT = 0.0538*(TCRT-4.0831)**3+-0.315*(TCRT-4.0831)**2+-2.9403*(TCRT-4.0831)+8.6647                                                                                    
              YT = -0.0456*(TCRT-4.0831)**3+-0.1044*(TCRT-4.0831)**2+1.0479*(TCRT-4.0831)+25.5349                                                                                    
              ZT = 0.0573*(TCRT-4.0831)**3+0.3013*(TCRT-4.0831)**2+-2.0787*(TCRT-4.0831)+-12.2443                                                                                    
          ELSEIF (TCRT <= 4.9066) THEN                                             
              XW = 0.028*(TCRT-4.4944)**3+-0.2624*(TCRT-4.4944)**2+-3.2925*(TCRT-4.4944)+7.6243                                                                                    
              YW = -0.0315*(TCRT-4.4944)**3+-0.1713*(TCRT-4.4944)**2+1.0304*(TCRT-4.4944)+24.9528                                                                                    
              ZW = 0.0247*(TCRT-4.4944)**3+0.3757*(TCRT-4.4944)**2+-1.8224*(TCRT-4.4944)+-13.9309                                                                                    
              XF = XW+0.028*3*(TCRT-4.4944)**2+-0.2624*2*(TCRT-4.4944)+-3.2925                                                                                 
              YF = YW+-0.0315*3*(TCRT-4.4944)**2+-0.1713*2*(TCRT-4.4944)+1.0304                                                                                 
              ZF = ZW+0.0247*3*(TCRT-4.4944)**2+0.3757*2*(TCRT-4.4944)+-1.8224                                                                                 
              XT = 0.0139*(TCRT-4.4944)**3+-0.2486*(TCRT-4.4944)**2+-3.1722*(TCRT-4.4944)+7.4057                                                                                    
              YT = -0.0229*(TCRT-4.4944)**3+-0.1607*(TCRT-4.4944)**2+0.9389*(TCRT-4.4944)+25.9451                                                                                    
              ZT = 0.0156*(TCRT-4.4944)**3+0.372*(TCRT-4.4944)**2+-1.8018*(TCRT-4.4944)+-13.0444                                                                                    
          ELSEIF (TCRT <= 5.3195) THEN                                             
              XW = 0.0359*(TCRT-4.9066)**3+-0.2278*(TCRT-4.9066)**2+-3.4946*(TCRT-4.9066)+6.2245                                                                                    
              YW = -0.0274*(TCRT-4.9066)**3+-0.2103*(TCRT-4.9066)**2+0.8731*(TCRT-4.9066)+25.3462                                                                                    
              ZW = 0.0233*(TCRT-4.9066)**3+0.4062*(TCRT-4.9066)**2+-1.5001*(TCRT-4.9066)+-14.6165                                                                                    
              XF = XW+0.0359*3*(TCRT-4.9066)**2+-0.2278*2*(TCRT-4.9066)+-3.4946                                                                                 
              YF = YW+-0.0274*3*(TCRT-4.9066)**2+-0.2103*2*(TCRT-4.9066)+0.8731                                                                                 
              ZF = ZW+0.0233*3*(TCRT-4.9066)**2+0.4062*2*(TCRT-4.9066)+-1.5001                                                                                 
              XT = 0.0235*(TCRT-4.9066)**3+-0.2314*(TCRT-4.9066)**2+-3.37*(TCRT-4.9066)+6.0569                                                                                    
              YT = -0.024*(TCRT-4.9066)**3+-0.189*(TCRT-4.9066)**2+0.7947*(TCRT-4.9066)+26.3032                                                                                    
              ZT = 0.0252*(TCRT-4.9066)**3+0.3913*(TCRT-4.9066)**2+-1.4872*(TCRT-4.9066)+-13.7228                                                                                    
          ELSEIF (TCRT <= 5.733) THEN                                             
              XW = 0.0438*(TCRT-5.3195)**3+-0.1834*(TCRT-5.3195)**2+-3.6643*(TCRT-5.3195)+4.7453                                                                                    
              YW = -0.0214*(TCRT-5.3195)**3+-0.2443*(TCRT-5.3195)**2+0.6854*(TCRT-5.3195)+25.669                                                                                    
              ZW = 0.0194*(TCRT-5.3195)**3+0.4351*(TCRT-5.3195)**2+-1.1527*(TCRT-5.3195)+-15.165                                                                                    
              XF = XW+0.0438*3*(TCRT-5.3195)**2+-0.1834*2*(TCRT-5.3195)+-3.6643                                                                                 
              YF = YW+-0.0214*3*(TCRT-5.3195)**2+-0.2443*2*(TCRT-5.3195)+0.6854                                                                                 
              ZF = ZW+0.0194*3*(TCRT-5.3195)**2+0.4351*2*(TCRT-5.3195)+-1.1527                                                                                 
              XT = 0.0352*(TCRT-5.3195)**3+-0.2022*(TCRT-5.3195)**2+-3.549*(TCRT-5.3195)+4.6276                                                                                    
              YT = -0.022*(TCRT-5.3195)**3+-0.2187*(TCRT-5.3195)**2+0.6264*(TCRT-5.3195)+26.5974                                                                                    
              ZT = 0.0263*(TCRT-5.3195)**3+0.4225*(TCRT-5.3195)**2+-1.1511*(TCRT-5.3195)+-14.2683                                                                                    
          ELSEIF (TCRT <= 6.1457) THEN                                             
              XW = 0.05*(TCRT-5.733)**3+-0.129*(TCRT-5.733)**2+-3.7935*(TCRT-5.733)+3.2017                                                                                    
              YW = -0.0138*(TCRT-5.733)**3+-0.2709*(TCRT-5.733)**2+0.4724*(TCRT-5.733)+25.9091                                                                                    
              ZW = 0.0129*(TCRT-5.733)**3+0.4592*(TCRT-5.733)**2+-0.7829*(TCRT-5.733)+-15.5659                                                                                    
              XF = XW+0.05*3*(TCRT-5.733)**2+-0.129*2*(TCRT-5.733)+-3.7935                                                                                 
              YF = YW+-0.0138*3*(TCRT-5.733)**2+-0.2709*2*(TCRT-5.733)+0.4724                                                                                 
              ZF = ZW+0.0129*3*(TCRT-5.733)**2+0.4592*2*(TCRT-5.733)+-0.7829                                                                                 
              XT = 0.0822*(TCRT-5.733)**3+-0.1586*(TCRT-5.733)**2+-3.6983*(TCRT-5.733)+3.1279                                                                                    
              YT = -0.0164*(TCRT-5.733)**3+-0.246*(TCRT-5.733)**2+0.4342*(TCRT-5.733)+26.8175                                                                                    
              ZT = 0.0215*(TCRT-5.733)**3+0.4552*(TCRT-5.733)**2+-0.7882*(TCRT-5.733)+-14.6703                                                                                    
          ELSEIF (TCRT <= 6.5613) THEN                                             
              XW = 0.0538*(TCRT-6.1457)**3+-0.0671*(TCRT-6.1457)**2+-3.8744*(TCRT-6.1457)+1.6178                                                                                    
              YW = -0.0048*(TCRT-6.1457)**3+-0.288*(TCRT-6.1457)**2+0.2418*(TCRT-6.1457)+26.057                                                                                    
              ZW = 0.0046*(TCRT-6.1457)**3+0.4752*(TCRT-6.1457)**2+-0.3973*(TCRT-6.1457)+-15.8099                                                                                    
              XF = XW+0.0538*3*(TCRT-6.1457)**2+-0.0671*2*(TCRT-6.1457)+-3.8744                                                                                 
              YF = YW+-0.0048*3*(TCRT-6.1457)**2+-0.288*2*(TCRT-6.1457)+0.2418                                                                                 
              ZF = ZW+0.0046*3*(TCRT-6.1457)**2+0.4752*2*(TCRT-6.1457)+-0.3973                                                                                 
              XT = 0.0441*(TCRT-6.1457)**3+-0.0568*(TCRT-6.1457)**2+-3.7872*(TCRT-6.1457)+1.5804                                                                                    
              YT = -0.0028*(TCRT-6.1457)**3+-0.2664*(TCRT-6.1457)**2+0.2228*(TCRT-6.1457)+26.9536                                                                                    
              ZT = 0.0023*(TCRT-6.1457)**3+0.4818*(TCRT-6.1457)**2+-0.4015*(TCRT-6.1457)+-14.9165                                                                                    
          ELSEIF (TCRT <= 6.9768) THEN                                             
              XW = 0.0538*(TCRT-6.5613)**3+0.0*(TCRT-6.5613)**2+-3.9023*(TCRT-6.5613)+0.0                                                                                    
              YW = 0.0048*(TCRT-6.5613)**3+-0.2939*(TCRT-6.5613)**2+0.0*(TCRT-6.5613)+26.1074                                                                                    
              ZW = -0.0046*(TCRT-6.5613)**3+0.4809*(TCRT-6.5613)**2+0.0*(TCRT-6.5613)+-15.8926                                                                                    
              XF = XW+0.0538*3*(TCRT-6.5613)**2+0.0*2*(TCRT-6.5613)+-3.9023                                                                                 
              YF = YW+0.0048*3*(TCRT-6.5613)**2+-0.2939*2*(TCRT-6.5613)+0.0                                                                                 
              ZF = ZW+-0.0046*3*(TCRT-6.5613)**2+0.4809*2*(TCRT-6.5613)+0.0                                                                                 
              XT = 0.0529*(TCRT-6.5613)**3+-0.0019*(TCRT-6.5613)**2+-3.8116*(TCRT-6.5613)+0.0                                                                                    
              YT = 0.0035*(TCRT-6.5613)**3+-0.2699*(TCRT-6.5613)**2+-0.0001*(TCRT-6.5613)+27.0                                                                                    
              ZT = -0.0036*(TCRT-6.5613)**3+0.4847*(TCRT-6.5613)**2+0.0001*(TCRT-6.5613)+-15.0                                                                                    
          ELSEIF (TCRT <= 7.3895) THEN                                             
              XW = 0.05*(TCRT-6.9768)**3+0.0671*(TCRT-6.9768)**2+-3.8744*(TCRT-6.9768)+-1.6178                                                                                    
              YW = 0.0138*(TCRT-6.9768)**3+-0.288*(TCRT-6.9768)**2+-0.2418*(TCRT-6.9768)+26.057                                                                                    
              ZW = -0.0129*(TCRT-6.9768)**3+0.4752*(TCRT-6.9768)**2+0.3973*(TCRT-6.9768)+-15.8099                                                                                    
              XF = XW+0.05*3*(TCRT-6.9768)**2+0.0671*2*(TCRT-6.9768)+-3.8744                                                                                 
              YF = YW+0.0138*3*(TCRT-6.9768)**2+-0.288*2*(TCRT-6.9768)+-0.2418                                                                                 
              ZF = ZW+-0.0129*3*(TCRT-6.9768)**2+0.4752*2*(TCRT-6.9768)+0.3973                                                                                 
              XT = 0.0619*(TCRT-6.9768)**3+0.0641*(TCRT-6.9768)**2+-3.7857*(TCRT-6.9768)+-1.5805                                                                                    
              YT = 0.0135*(TCRT-6.9768)**3+-0.2655*(TCRT-6.9768)**2+-0.2225*(TCRT-6.9768)+26.9536                                                                                    
              ZT = -0.0162*(TCRT-6.9768)**3+0.4802*(TCRT-6.9768)**2+0.4011*(TCRT-6.9768)+-14.9165                                                                                    
          ELSEIF (TCRT <= 7.8031) THEN                                             
              XW = 0.0438*(TCRT-7.3895)**3+0.129*(TCRT-7.3895)**2+-3.7935*(TCRT-7.3895)+-3.2019                                                                                    
              YW = 0.0214*(TCRT-7.3895)**3+-0.2709*(TCRT-7.3895)**2+-0.4724*(TCRT-7.3895)+25.9091                                                                                    
              ZW = -0.0194*(TCRT-7.3895)**3+0.4592*(TCRT-7.3895)**2+0.7829*(TCRT-7.3895)+-15.5659                                                                                    
              XF = XW+0.0438*3*(TCRT-7.3895)**2+0.129*2*(TCRT-7.3895)+-3.7935                                                                                 
              YF = YW+0.0214*3*(TCRT-7.3895)**2+-0.2709*2*(TCRT-7.3895)+-0.4724                                                                                 
              ZF = ZW+-0.0194*3*(TCRT-7.3895)**2+0.4592*2*(TCRT-7.3895)+0.7829                                                                                 
              XT = 0.0914*(TCRT-7.3895)**3+0.1407*(TCRT-7.3895)**2+-3.7012*(TCRT-7.3895)+-3.1276                                                                                    
              YT = 0.0314*(TCRT-7.3895)**3+-0.2488*(TCRT-7.3895)**2+-0.4348*(TCRT-7.3895)+26.8175                                                                                    
              ZT = -0.0431*(TCRT-7.3895)**3+0.4601*(TCRT-7.3895)**2+0.7892*(TCRT-7.3895)+-14.6703                                                                                    
          ELSEIF (TCRT <= 8.216) THEN                                             
              XW = 0.0359*(TCRT-7.8031)**3+0.1834*(TCRT-7.8031)**2+-3.6643*(TCRT-7.8031)+-4.7455                                                                                    
              YW = 0.0274*(TCRT-7.8031)**3+-0.2443*(TCRT-7.8031)**2+-0.6855*(TCRT-7.8031)+25.6689                                                                                    
              ZW = -0.0233*(TCRT-7.8031)**3+0.4351*(TCRT-7.8031)**2+1.1528*(TCRT-7.8031)+-15.1649                                                                                    
              XF = XW+0.0359*3*(TCRT-7.8031)**2+0.1834*2*(TCRT-7.8031)+-3.6643                                                                                 
              YF = YW+0.0274*3*(TCRT-7.8031)**2+-0.2443*2*(TCRT-7.8031)+-0.6855                                                                                 
              ZF = ZW+-0.0233*3*(TCRT-7.8031)**2+0.4351*2*(TCRT-7.8031)+1.1528                                                                                 
              XT = 0.0059*(TCRT-7.8031)**3+0.2541*(TCRT-7.8031)**2+-3.5379*(TCRT-7.8031)+-4.6277                                                                                    
              YT = 0.0318*(TCRT-7.8031)**3+-0.2099*(TCRT-7.8031)**2+-0.6244*(TCRT-7.8031)+26.5974                                                                                    
              ZT = -0.0425*(TCRT-7.8031)**3+0.4067*(TCRT-7.8031)**2+1.1477*(TCRT-7.8031)+-14.2683                                                                                    
          ELSEIF (TCRT <= 8.6282) THEN                                             
              XW = 0.028*(TCRT-8.216)**3+0.2278*(TCRT-8.216)**2+-3.4945*(TCRT-8.216)+-6.2247                                                                                    
              YW = 0.0316*(TCRT-8.216)**3+-0.2103*(TCRT-8.216)**2+-0.8732*(TCRT-8.216)+25.3462                                                                                    
              ZW = -0.0247*(TCRT-8.216)**3+0.4062*(TCRT-8.216)**2+1.5002*(TCRT-8.216)+-14.6164                                                                                    
              XF = XW+0.028*3*(TCRT-8.216)**2+0.2278*2*(TCRT-8.216)+-3.4945                                                                                 
              YF = YW+0.0316*3*(TCRT-8.216)**2+-0.2103*2*(TCRT-8.216)+-0.8732                                                                                 
              ZF = ZW+-0.0247*3*(TCRT-8.216)**2+0.4062*2*(TCRT-8.216)+1.5002                                                                                 
              XT = -0.1728*(TCRT-8.216)**3+0.2614*(TCRT-8.216)**2+-3.3251*(TCRT-8.216)+-6.0448                                                                                    
              YT = -0.0452*(TCRT-8.216)**3+-0.1705*(TCRT-8.216)**2+-0.7815*(TCRT-8.216)+26.306                                                                                    
              ZT = 0.1177*(TCRT-8.216)**3+0.354*(TCRT-8.216)**2+1.4617*(TCRT-8.216)+-13.7281                                                                                    
          ELSEIF (TCRT <= 9.0396) THEN                                             
              XW = 0.0211*(TCRT-8.6282)**3+0.2624*(TCRT-8.6282)**2+-3.2925*(TCRT-8.6282)+-7.6245                                                                                    
              YW = 0.0345*(TCRT-8.6282)**3+-0.1713*(TCRT-8.6282)**2+-1.0305*(TCRT-8.6282)+24.9528                                                                                    
              ZW = -0.024*(TCRT-8.6282)**3+0.3757*(TCRT-8.6282)**2+1.8225*(TCRT-8.6282)+-13.9308                                                                                    
              XF = XW+0.0211*3*(TCRT-8.6282)**2+0.2624*2*(TCRT-8.6282)+-3.2925                                                                                 
              YF = YW+0.0345*3*(TCRT-8.6282)**2+-0.1713*2*(TCRT-8.6282)+-1.0305                                                                                 
              ZF = ZW+-0.024*3*(TCRT-8.6282)**2+0.3757*2*(TCRT-8.6282)+1.8225                                                                                 
              XT = 0.3556*(TCRT-8.6282)**3+0.0477*(TCRT-8.6282)**2+-3.1977*(TCRT-8.6282)+-7.3831                                                                                    
              YT = 0.1418*(TCRT-8.6282)**3+-0.2264*(TCRT-8.6282)**2+-0.9451*(TCRT-8.6282)+25.9518                                                                                    
              ZT = -0.2435*(TCRT-8.6282)**3+0.4995*(TCRT-8.6282)**2+1.8135*(TCRT-8.6282)+-13.0572                                                                                    
          ELSEIF (TCRT <= 9.4502) THEN                                             
              XW = 0.0159*(TCRT-9.0396)**3+0.2885*(TCRT-9.0396)**2+-3.0658*(TCRT-9.0396)+-8.9332                                                                                    
              YW = 0.0368*(TCRT-9.0396)**3+-0.1287*(TCRT-9.0396)**2+-1.1539*(TCRT-9.0396)+24.5022                                                                                    
              ZW = -0.0218*(TCRT-9.0396)**3+0.3461*(TCRT-9.0396)**2+2.1194*(TCRT-9.0396)+-13.1191                                                                                    
              XF = XW+0.0159*3*(TCRT-9.0396)**2+0.2885*2*(TCRT-9.0396)+-3.0658                                                                                 
              YF = YW+0.0368*3*(TCRT-9.0396)**2+-0.1287*2*(TCRT-9.0396)+-1.1539                                                                                 
              ZF = ZW+-0.0218*3*(TCRT-9.0396)**2+0.3461*2*(TCRT-9.0396)+2.1194                                                                                 
              XT = -0.2313*(TCRT-9.0396)**3+0.4865*(TCRT-9.0396)**2+-2.978*(TCRT-9.0396)+-8.6658                                                                                    
              YT = -0.0545*(TCRT-9.0396)**3+-0.0514*(TCRT-9.0396)**2+-1.0594*(TCRT-9.0396)+25.5345                                                                                    
              ZT = 0.1565*(TCRT-9.0396)**3+0.1989*(TCRT-9.0396)**2+2.1009*(TCRT-9.0396)+-12.2435                                                                                    
          ELSEIF (TCRT <= 9.8599) THEN                                             
              XW = 0.0127*(TCRT-9.4502)**3+0.3081*(TCRT-9.4502)**2+-2.8208*(TCRT-9.4502)+-10.1421                                                                                    
              YW = 0.0391*(TCRT-9.4502)**3+-0.0833*(TCRT-9.4502)**2+-1.2409*(TCRT-9.4502)+24.0094                                                                                    
              ZW = -0.0189*(TCRT-9.4502)**3+0.3193*(TCRT-9.4502)**2+2.3926*(TCRT-9.4502)+-12.1921                                                                                    
              XF = XW+0.0127*3*(TCRT-9.4502)**2+0.3081*2*(TCRT-9.4502)+-2.8208                                                                                 
              YF = YW+0.0391*3*(TCRT-9.4502)**2+-0.0833*2*(TCRT-9.4502)+-1.2409                                                                                 
              ZF = ZW+-0.0189*3*(TCRT-9.4502)**2+0.3193*2*(TCRT-9.4502)+2.3926                                                                                 
              XT = 0.2905*(TCRT-9.4502)**3+0.2016*(TCRT-9.4502)**2+-2.6955*(TCRT-9.4502)+-9.8225                                                                                    
              YT = 0.1713*(TCRT-9.4502)**3+-0.1185*(TCRT-9.4502)**2+-1.1291*(TCRT-9.4502)+25.0871                                                                                    
              ZT = -0.3273*(TCRT-9.4502)**3+0.3917*(TCRT-9.4502)**2+2.3433*(TCRT-9.4502)+-11.3366                                                                                    
          ELSEIF (TCRT <= 10.2689) THEN                                             
              XW = 0.0114*(TCRT-9.8599)**3+0.3238*(TCRT-9.8599)**2+-2.562*(TCRT-9.8599)+-11.2453                                                                                    
              YW = 0.042*(TCRT-9.8599)**3+-0.0352*(TCRT-9.8599)**2+-1.2895*(TCRT-9.8599)+23.4896                                                                                    
              ZW = -0.0162*(TCRT-9.8599)**3+0.2961*(TCRT-9.8599)**2+2.6447*(TCRT-9.8599)+-11.1595                                                                                    
              XF = XW+0.0114*3*(TCRT-9.8599)**2+0.3238*2*(TCRT-9.8599)+-2.562                                                                                 
              YF = YW+0.042*3*(TCRT-9.8599)**2+-0.0352*2*(TCRT-9.8599)+-1.2895                                                                                 
              ZF = ZW+-0.0162*3*(TCRT-9.8599)**2+0.2961*2*(TCRT-9.8599)+2.6447                                                                                 
              XT = -0.33*(TCRT-9.8599)**3+0.5587*(TCRT-9.8599)**2+-2.384*(TCRT-9.8599)+-10.873                                                                                    
              YT = -0.1268*(TCRT-9.8599)**3+0.092*(TCRT-9.8599)**2+-1.14*(TCRT-9.8599)+24.6164                                                                                    
              ZT = 0.3392*(TCRT-9.8599)**3+-0.0107*(TCRT-9.8599)**2+2.4994*(TCRT-9.8599)+-10.3333                                                                                    
          ELSEIF (TCRT <= 10.677) THEN                                             
              XW = 0.0119*(TCRT-10.2689)**3+0.3378*(TCRT-10.2689)**2+-2.2914*(TCRT-10.2689)+-12.2382                                                                                    
              YW = 0.0457*(TCRT-10.2689)**3+0.0164*(TCRT-10.2689)**2+-1.2972*(TCRT-10.2689)+22.9592                                                                                    
              ZW = -0.0145*(TCRT-10.2689)**3+0.2763*(TCRT-10.2689)**2+2.8788*(TCRT-10.2689)+-10.0294                                                                                    
              XF = XW+0.0119*3*(TCRT-10.2689)**2+0.3378*2*(TCRT-10.2689)+-2.2914                                                                                 
              YF = YW+0.0457*3*(TCRT-10.2689)**2+0.0164*2*(TCRT-10.2689)+-1.2972                                                                                 
              ZF = ZW+-0.0145*3*(TCRT-10.2689)**2+0.2763*2*(TCRT-10.2689)+2.8788                                                                                 
              XT = 0.1669*(TCRT-10.2689)**3+0.1537*(TCRT-10.2689)**2+-2.0926*(TCRT-10.2689)+-11.7773                                                                                    
              YT = 0.112*(TCRT-10.2689)**3+-0.0636*(TCRT-10.2689)**2+-1.1284*(TCRT-10.2689)+24.1568                                                                                    
              ZT = -0.1689*(TCRT-10.2689)**3+0.4055*(TCRT-10.2689)**2+2.6609*(TCRT-10.2689)+-9.2896                                                                                    
          ELSEIF (TCRT <= 11.0844) THEN                                             
              XW = 0.0138*(TCRT-10.677)**3+0.3524*(TCRT-10.677)**2+-2.0097*(TCRT-10.677)+-13.1162                                                                                    
              YW = 0.0501*(TCRT-10.677)**3+0.0723*(TCRT-10.677)**2+-1.261*(TCRT-10.677)+22.4357                                                                                    
              ZW = -0.0148*(TCRT-10.677)**3+0.2586*(TCRT-10.677)**2+3.0971*(TCRT-10.677)+-8.8095                                                                                    
              XF = XW+0.0138*3*(TCRT-10.677)**2+0.3524*2*(TCRT-10.677)+-2.0097                                                                                 
              YF = YW+0.0501*3*(TCRT-10.677)**2+0.0723*2*(TCRT-10.677)+-1.261                                                                                 
              ZF = ZW+-0.0148*3*(TCRT-10.677)**2+0.2586*2*(TCRT-10.677)+3.0971                                                                                 
              XT = -0.0131*(TCRT-10.677)**3+0.3581*(TCRT-10.677)**2+-1.8838*(TCRT-10.677)+-12.5943                                                                                    
              YT = 0.0343*(TCRT-10.677)**3+0.0735*(TCRT-10.677)**2+-1.1244*(TCRT-10.677)+23.6933                                                                                    
              ZT = 0.0014*(TCRT-10.677)**3+0.1987*(TCRT-10.677)**2+2.9075*(TCRT-10.677)+-8.1476                                                                                    
          ELSEIF (TCRT <= 11.4915) THEN                                             
              XW = 0.0165*(TCRT-11.0844)**3+0.3693*(TCRT-11.0844)**2+-1.7157*(TCRT-11.0844)+-13.8757                                                                                    
              YW = 0.0543*(TCRT-11.0844)**3+0.1336*(TCRT-11.0844)**2+-1.1771*(TCRT-11.0844)+21.9373                                                                                    
              ZW = -0.0183*(TCRT-11.0844)**3+0.2405*(TCRT-11.0844)**2+3.3004*(TCRT-11.0844)+-7.5057                                                                                    
              XF = XW+0.0165*3*(TCRT-11.0844)**2+0.3693*2*(TCRT-11.0844)+-1.7157                                                                                 
              YF = YW+0.0543*3*(TCRT-11.0844)**2+0.1336*2*(TCRT-11.0844)+-1.1771                                                                                 
              ZF = ZW+-0.0183*3*(TCRT-11.0844)**2+0.2405*2*(TCRT-11.0844)+3.3004                                                                                 
              XT = 0.0177*(TCRT-11.0844)**3+0.3421*(TCRT-11.0844)**2+-1.5985*(TCRT-11.0844)+-13.3033                                                                                    
              YT = 0.0487*(TCRT-11.0844)**3+0.1154*(TCRT-11.0844)**2+-1.0474*(TCRT-11.0844)+23.2497                                                                                    
              ZT = -0.0156*(TCRT-11.0844)**3+0.2004*(TCRT-11.0844)**2+3.0702*(TCRT-11.0844)+-6.9298                                                                                    
          ELSEIF (TCRT <= 11.8985) THEN                                             
              XW = 0.0187*(TCRT-11.4915)**3+0.3894*(TCRT-11.4915)**2+-1.4068*(TCRT-11.4915)+-14.5118                                                                                    
              YW = 0.0561*(TCRT-11.4915)**3+0.1999*(TCRT-11.4915)**2+-1.0413*(TCRT-11.4915)+21.4839                                                                                    
              ZW = -0.0262*(TCRT-11.4915)**3+0.2181*(TCRT-11.4915)**2+3.4871*(TCRT-11.4915)+-6.1235                                                                                    
              XF = XW+0.0187*3*(TCRT-11.4915)**2+0.3894*2*(TCRT-11.4915)+-1.4068                                                                                 
              YF = YW+0.0561*3*(TCRT-11.4915)**2+0.1999*2*(TCRT-11.4915)+-1.0413                                                                                 
              ZF = ZW+-0.0262*3*(TCRT-11.4915)**2+0.2181*2*(TCRT-11.4915)+3.4871                                                                                 
              XT = 0.0134*(TCRT-11.4915)**3+0.3637*(TCRT-11.4915)**2+-1.3111*(TCRT-11.4915)+-13.8961                                                                                    
              YT = 0.0485*(TCRT-11.4915)**3+0.1749*(TCRT-11.4915)**2+-0.9292*(TCRT-11.4915)+22.8457                                                                                    
              ZT = -0.0183*(TCRT-11.4915)**3+0.1813*(TCRT-11.4915)**2+3.2256*(TCRT-11.4915)+-5.6478                                                                                    
          ELSEIF (TCRT <= 12.3058) THEN                                             
              XW = 0.0187*(TCRT-11.8985)**3+0.4123*(TCRT-11.8985)**2+-1.0805*(TCRT-11.8985)+-15.0186                                                                                    
              YW = 0.0519*(TCRT-11.8985)**3+0.2683*(TCRT-11.8985)**2+-0.8508*(TCRT-11.8985)+21.097                                                                                    
              ZW = -0.0383*(TCRT-11.8985)**3+0.186*(TCRT-11.8985)**2+3.6516*(TCRT-11.8985)+-4.6699                                                                                    
              XF = XW+0.0187*3*(TCRT-11.8985)**2+0.4123*2*(TCRT-11.8985)+-1.0805                                                                                 
              YF = YW+0.0519*3*(TCRT-11.8985)**2+0.2683*2*(TCRT-11.8985)+-0.8508                                                                                 
              ZF = ZW+-0.0383*3*(TCRT-11.8985)**2+0.186*2*(TCRT-11.8985)+3.6516                                                                                 
              XT = 0.0201*(TCRT-11.8985)**3+0.38*(TCRT-11.8985)**2+-1.0084*(TCRT-11.8985)+-14.3686                                                                                    
              YT = 0.0499*(TCRT-11.8985)**3+0.2341*(TCRT-11.8985)**2+-0.7628*(TCRT-11.8985)+22.4997                                                                                    
              ZT = -0.012*(TCRT-11.8985)**3+0.159*(TCRT-11.8985)**2+3.3641*(TCRT-11.8985)+-4.3063                                                                                    
          ELSEIF (TCRT <= 12.7139) THEN                                             
              XW = 0.0145*(TCRT-12.3058)**3+0.4351*(TCRT-12.3058)**2+-0.7354*(TCRT-12.3058)+-15.389                                                                                    
              YW = 0.0382*(TCRT-12.3058)**3+0.3318*(TCRT-12.3058)**2+-0.6064*(TCRT-12.3058)+20.7985                                                                                    
              ZW = -0.052*(TCRT-12.3058)**3+0.1392*(TCRT-12.3058)**2+3.784*(TCRT-12.3058)+-3.1544                                                                                    
              XF = XW+0.0145*3*(TCRT-12.3058)**2+0.4351*2*(TCRT-12.3058)+-0.7354                                                                                 
              YF = YW+0.0382*3*(TCRT-12.3058)**2+0.3318*2*(TCRT-12.3058)+-0.6064                                                                                 
              ZF = ZW+-0.052*3*(TCRT-12.3058)**2+0.1392*2*(TCRT-12.3058)+3.784                                                                                 
              XT = 0.0117*(TCRT-12.3058)**3+0.4046*(TCRT-12.3058)**2+-0.6889*(TCRT-12.3058)+-14.7149                                                                                    
              YT = 0.0346*(TCRT-12.3058)**3+0.2951*(TCRT-12.3058)**2+-0.5473*(TCRT-12.3058)+22.2312                                                                                    
              ZT = -0.0863*(TCRT-12.3058)**3+0.1443*(TCRT-12.3058)**2+3.4876*(TCRT-12.3058)+-2.9105                                                                                    
          ELSEIF (TCRT <= 13.1225) THEN                                             
              XW = 0.0056*(TCRT-12.7139)**3+0.4529*(TCRT-12.7139)**2+-0.373*(TCRT-12.7139)+-15.6157                                                                                    
              YW = 0.0142*(TCRT-12.7139)**3+0.3785*(TCRT-12.7139)**2+-0.3165*(TCRT-12.7139)+20.6089                                                                                    
              ZW = -0.0616*(TCRT-12.7139)**3+0.0755*(TCRT-12.7139)**2+3.8717*(TCRT-12.7139)+-1.5906                                                                                    
              XF = XW+0.0056*3*(TCRT-12.7139)**2+0.4529*2*(TCRT-12.7139)+-0.373                                                                                 
              YF = YW+0.0142*3*(TCRT-12.7139)**2+0.3785*2*(TCRT-12.7139)+-0.3165                                                                                 
              ZF = ZW+-0.0616*3*(TCRT-12.7139)**2+0.0755*2*(TCRT-12.7139)+3.8717                                                                                 
              XT = 0.0314*(TCRT-12.7139)**3+0.4188*(TCRT-12.7139)**2+-0.3529*(TCRT-12.7139)+-14.9279                                                                                    
              YT = 0.035*(TCRT-12.7139)**3+0.3375*(TCRT-12.7139)**2+-0.2891*(TCRT-12.7139)+22.0594                                                                                    
              ZT = 0.1019*(TCRT-12.7139)**3+0.0387*(TCRT-12.7139)**2+3.5623*(TCRT-12.7139)+-1.4692                                                                                    
          ELSEIF (TCRT <= 13.5312) THEN                                             
              XW = -0.0056*(TCRT-13.1225)**3+0.4598*(TCRT-13.1225)**2+0.0*(TCRT-13.1225)+-15.6921                                                                                    
              YW = -0.0142*(TCRT-13.1225)**3+0.396*(TCRT-13.1225)**2+0.0*(TCRT-13.1225)+20.5437                                                                                    
              ZW = -0.0616*(TCRT-13.1225)**3+0.0*(TCRT-13.1225)**2+3.9025*(TCRT-13.1225)+0.0                                                                                    
              XF = XW+-0.0056*3*(TCRT-13.1225)**2+0.4598*2*(TCRT-13.1225)+0.0                                                                                 
              YF = YW+-0.0142*3*(TCRT-13.1225)**2+0.396*2*(TCRT-13.1225)+0.0                                                                                 
              ZF = ZW+-0.0616*3*(TCRT-13.1225)**2+0.0*2*(TCRT-13.1225)+3.9025                                                                                 
              XT = -0.0758*(TCRT-13.1225)**3+0.4574*(TCRT-13.1225)**2+0.0052*(TCRT-13.1225)+-15.0                                                                                    
              YT = -0.0706*(TCRT-13.1225)**3+0.3803*(TCRT-13.1225)**2+0.0042*(TCRT-13.1225)+22.0                                                                                    
              ZT = -0.5202*(TCRT-13.1225)**3+0.1637*(TCRT-13.1225)**2+3.645*(TCRT-13.1225)+0.0                                                                                    
          ELSEIF (TCRT <= 13.9393) THEN                                             
              XW = -0.0145*(TCRT-13.5312)**3+0.453*(TCRT-13.5312)**2+0.373*(TCRT-13.5312)+-15.6157                                                                                    
              YW = -0.0382*(TCRT-13.5312)**3+0.3785*(TCRT-13.5312)**2+0.3165*(TCRT-13.5312)+20.6089                                                                                    
              ZW = -0.052*(TCRT-13.5312)**3+-0.0755*(TCRT-13.5312)**2+3.8717*(TCRT-13.5312)+1.5907                                                                                    
              XF = XW+-0.0145*3*(TCRT-13.5312)**2+0.453*2*(TCRT-13.5312)+0.373                                                                                 
              YF = YW+-0.0382*3*(TCRT-13.5312)**2+0.3785*2*(TCRT-13.5312)+0.3165                                                                                 
              ZF = ZW+-0.052*3*(TCRT-13.5312)**2+-0.0755*2*(TCRT-13.5312)+3.8717                                                                                 
              XT = 0.0935*(TCRT-13.5312)**3+0.3645*(TCRT-13.5312)**2+0.3411*(TCRT-13.5312)+-14.9267                                                                                    
              YT = 0.0501*(TCRT-13.5312)**3+0.2937*(TCRT-13.5312)**2+0.2797*(TCRT-13.5312)+22.0604                                                                                    
              ZT = 0.6527*(TCRT-13.5312)**3+-0.4742*(TCRT-13.5312)**2+3.5181*(TCRT-13.5312)+1.4815                                                                                    
          ELSEIF (TCRT <= 14.3466) THEN                                             
              XW = -0.0187*(TCRT-13.9393)**3+0.4351*(TCRT-13.9393)**2+0.7354*(TCRT-13.9393)+-15.389                                                                                    
              YW = -0.0519*(TCRT-13.9393)**3+0.3318*(TCRT-13.9393)**2+0.6064*(TCRT-13.9393)+20.7985                                                                                    
              ZW = -0.0383*(TCRT-13.9393)**3+-0.1392*(TCRT-13.9393)**2+3.784*(TCRT-13.9393)+3.1544                                                                                    
              XF = XW+-0.0187*3*(TCRT-13.9393)**2+0.4351*2*(TCRT-13.9393)+0.7354                                                                                 
              YF = YW+-0.0519*3*(TCRT-13.9393)**2+0.3318*2*(TCRT-13.9393)+0.6064                                                                                 
              ZF = ZW+-0.0383*3*(TCRT-13.9393)**2+-0.1392*2*(TCRT-13.9393)+3.784                                                                                 
              XT = -0.0988*(TCRT-13.9393)**3+0.4789*(TCRT-13.9393)**2+0.6852*(TCRT-13.9393)+-14.7205                                                                                    
              YT = -0.1154*(TCRT-13.9393)**3+0.3551*(TCRT-13.9393)**2+0.5444*(TCRT-13.9393)+22.2268                                                                                    
              ZT = -0.5643*(TCRT-13.9393)**3+0.3248*(TCRT-13.9393)**2+3.4571*(TCRT-13.9393)+2.8824                                                                                    
          ELSEIF (TCRT <= 14.7536) THEN                                             
              XW = -0.0187*(TCRT-14.3466)**3+0.4123*(TCRT-14.3466)**2+1.0806*(TCRT-14.3466)+-15.0185                                                                                    
              YW = -0.0561*(TCRT-14.3466)**3+0.2683*(TCRT-14.3466)**2+0.8508*(TCRT-14.3466)+21.097                                                                                    
              ZW = -0.0262*(TCRT-14.3466)**3+-0.1861*(TCRT-14.3466)**2+3.6515*(TCRT-14.3466)+4.6701                                                                                    
              XF = XW+-0.0187*3*(TCRT-14.3466)**2+0.4123*2*(TCRT-14.3466)+1.0806                                                                                 
              YF = YW+-0.0561*3*(TCRT-14.3466)**2+0.2683*2*(TCRT-14.3466)+0.8508                                                                                 
              ZF = ZW+-0.0262*3*(TCRT-14.3466)**2+-0.1861*2*(TCRT-14.3466)+3.6515                                                                                 
              XT = -0.0465*(TCRT-14.3466)**3+0.3582*(TCRT-14.3466)**2+1.0262*(TCRT-14.3466)+-14.3686                                                                                    
              YT = -0.0663*(TCRT-14.3466)**3+0.2141*(TCRT-14.3466)**2+0.7763*(TCRT-14.3466)+22.4997                                                                                    
              ZT = 0.0748*(TCRT-14.3466)**3+-0.3648*(TCRT-14.3466)**2+3.4408*(TCRT-14.3466)+4.3064                                                                                    
          ELSEIF (TCRT <= 15.1607) THEN                                             
              XW = -0.0165*(TCRT-14.7536)**3+0.3894*(TCRT-14.7536)**2+1.4069*(TCRT-14.7536)+-14.5117                                                                                    
              YW = -0.0543*(TCRT-14.7536)**3+0.1999*(TCRT-14.7536)**2+1.0414*(TCRT-14.7536)+21.484                                                                                    
              ZW = -0.0184*(TCRT-14.7536)**3+-0.2181*(TCRT-14.7536)**2+3.4871*(TCRT-14.7536)+6.1237                                                                                    
              XF = XW+-0.0165*3*(TCRT-14.7536)**2+0.3894*2*(TCRT-14.7536)+1.4069                                                                                 
              YF = YW+-0.0543*3*(TCRT-14.7536)**2+0.1999*2*(TCRT-14.7536)+1.0414                                                                                 
              ZF = ZW+-0.0184*3*(TCRT-14.7536)**2+-0.2181*2*(TCRT-14.7536)+3.4871                                                                                 
              XT = 0.1007*(TCRT-14.7536)**3+0.3015*(TCRT-14.7536)**2+1.2947*(TCRT-14.7536)+-13.8947                                                                                    
              YT = 0.0354*(TCRT-14.7536)**3+0.1331*(TCRT-14.7536)**2+0.9176*(TCRT-14.7536)+22.8467                                                                                    
              ZT = 0.2117*(TCRT-14.7536)**3+-0.2735*(TCRT-14.7536)**2+3.181*(TCRT-14.7536)+5.6514                                                                                    
          ELSEIF (TCRT <= 15.5681) THEN                                             
              XW = -0.0138*(TCRT-15.1607)**3+0.3693*(TCRT-15.1607)**2+1.7157*(TCRT-15.1607)+-13.8756                                                                                    
              YW = -0.0501*(TCRT-15.1607)**3+0.1336*(TCRT-15.1607)**2+1.1771*(TCRT-15.1607)+21.9373                                                                                    
              ZW = -0.0148*(TCRT-15.1607)**3+-0.2405*(TCRT-15.1607)**2+3.3004*(TCRT-15.1607)+7.5057                                                                                    
              XF = XW+-0.0138*3*(TCRT-15.1607)**2+0.3693*2*(TCRT-15.1607)+1.7157                                                                                 
              YF = YW+-0.0501*3*(TCRT-15.1607)**2+0.1336*2*(TCRT-15.1607)+1.1771                                                                                 
              ZF = ZW+-0.0148*3*(TCRT-15.1607)**2+-0.2405*2*(TCRT-15.1607)+3.3004                                                                                 
              XT = 0.0457*(TCRT-15.1607)**3+0.4245*(TCRT-15.1607)**2+1.5902*(TCRT-15.1607)+-13.3109                                                                                    
              YT = -0.0438*(TCRT-15.1607)**3+0.1764*(TCRT-15.1607)**2+1.0436*(TCRT-15.1607)+23.2447                                                                                    
              ZT = -0.0858*(TCRT-15.1607)**3+-0.0149*(TCRT-15.1607)**2+3.0636*(TCRT-15.1607)+6.9152                                                                                    
          ELSEIF (TCRT <= 15.9763) THEN                                             
              XW = -0.0119*(TCRT-15.5681)**3+0.3524*(TCRT-15.5681)**2+2.0097*(TCRT-15.5681)+-13.1163                                                                                    
              YW = -0.0457*(TCRT-15.5681)**3+0.0723*(TCRT-15.5681)**2+1.261*(TCRT-15.5681)+22.4356                                                                                    
              ZW = -0.0145*(TCRT-15.5681)**3+-0.2585*(TCRT-15.5681)**2+3.0971*(TCRT-15.5681)+8.8094                                                                                    
              XF = XW+-0.0119*3*(TCRT-15.5681)**2+0.3524*2*(TCRT-15.5681)+2.0097                                                                                 
              YF = YW+-0.0457*3*(TCRT-15.5681)**2+0.0723*2*(TCRT-15.5681)+1.261                                                                                 
              ZF = ZW+-0.0145*3*(TCRT-15.5681)**2+-0.2585*2*(TCRT-15.5681)+3.0971                                                                                 
              XT = -0.6202*(TCRT-15.5681)**3+0.4803*(TCRT-15.5681)**2+1.9588*(TCRT-15.5681)+-12.5895                                                                                    
              YT = -0.3244*(TCRT-15.5681)**3+0.1228*(TCRT-15.5681)**2+1.1655*(TCRT-15.5681)+23.6962                                                                                    
              ZT = -0.6144*(TCRT-15.5681)**3+-0.1198*(TCRT-15.5681)**2+3.0087*(TCRT-15.5681)+8.155                                                                                    
          ELSEIF (TCRT <= 16.3852) THEN                                             
              XW = -0.0115*(TCRT-15.9763)**3+0.3378*(TCRT-15.9763)**2+2.2914*(TCRT-15.9763)+-12.238                                                                                    
              YW = -0.042*(TCRT-15.9763)**3+0.0163*(TCRT-15.9763)**2+1.2972*(TCRT-15.9763)+22.9593                                                                                    
              ZW = -0.0161*(TCRT-15.9763)**3+-0.2763*(TCRT-15.9763)**2+2.8788*(TCRT-15.9763)+10.0296                                                                                    
              XF = XW+-0.0115*3*(TCRT-15.9763)**2+0.3378*2*(TCRT-15.9763)+2.2914                                                                                 
              YF = YW+-0.042*3*(TCRT-15.9763)**2+0.0163*2*(TCRT-15.9763)+1.2972                                                                                 
              ZF = ZW+-0.0161*3*(TCRT-15.9763)**2+-0.2763*2*(TCRT-15.9763)+2.8788                                                                                 
              XT = 1.2668*(TCRT-15.9763)**3+-0.2793*(TCRT-15.9763)**2+2.0409*(TCRT-15.9763)+-11.752                                                                                    
              YT = 0.5626*(TCRT-15.9763)**3+-0.2745*(TCRT-15.9763)**2+1.1036*(TCRT-15.9763)+24.1703                                                                                    
              ZT = 1.2899*(TCRT-15.9763)**3+-0.8722*(TCRT-15.9763)**2+2.6038*(TCRT-15.9763)+9.3215                                                                                    
          ELSEIF (TCRT <= 16.7949) THEN                                             
              XW = -0.0127*(TCRT-16.3852)**3+0.3237*(TCRT-16.3852)**2+2.562*(TCRT-16.3852)+-11.2452                                                                                    
              YW = -0.0391*(TCRT-16.3852)**3+-0.0352*(TCRT-16.3852)**2+1.2895*(TCRT-16.3852)+23.4897                                                                                    
              ZW = -0.0189*(TCRT-16.3852)**3+-0.2961*(TCRT-16.3852)**2+2.6447*(TCRT-16.3852)+11.1596                                                                                    
              XF = XW+-0.0127*3*(TCRT-16.3852)**2+0.3237*2*(TCRT-16.3852)+2.562                                                                                 
              YF = YW+-0.0391*3*(TCRT-16.3852)**2+-0.0352*2*(TCRT-16.3852)+1.2895                                                                                 
              ZF = ZW+-0.0189*3*(TCRT-16.3852)**2+-0.2961*2*(TCRT-16.3852)+2.6447                                                                                 
              XT = -1.5398*(TCRT-16.3852)**3+1.2749*(TCRT-16.3852)**2+2.4481*(TCRT-16.3852)+-10.8775                                                                                    
              YT = -0.7183*(TCRT-16.3852)**3+0.4158*(TCRT-16.3852)**2+1.1614*(TCRT-16.3852)+24.6142                                                                                    
              ZT = -1.4911*(TCRT-16.3852)**3+0.7104*(TCRT-16.3852)**2+2.5376*(TCRT-16.3852)+10.3286                                                                                    
          ELSEIF (TCRT <= 17.2055) THEN                                             
              XW = -0.0159*(TCRT-16.7949)**3+0.3081*(TCRT-16.7949)**2+2.8209*(TCRT-16.7949)+-10.1421                                                                                    
              YW = -0.0369*(TCRT-16.7949)**3+-0.0833*(TCRT-16.7949)**2+1.2409*(TCRT-16.7949)+24.0094                                                                                    
              ZW = -0.0217*(TCRT-16.7949)**3+-0.3193*(TCRT-16.7949)**2+2.3926*(TCRT-16.7949)+12.1921                                                                                    
              XF = XW+-0.0159*3*(TCRT-16.7949)**2+0.3081*2*(TCRT-16.7949)+2.8209                                                                                 
              YF = YW+-0.0369*3*(TCRT-16.7949)**2+-0.0833*2*(TCRT-16.7949)+1.2409                                                                                 
              ZF = ZW+-0.0217*3*(TCRT-16.7949)**2+-0.3193*2*(TCRT-16.7949)+2.3926                                                                                 
              XT = 1.3037*(TCRT-16.7949)**3+-0.6176*(TCRT-16.7949)**2+2.7173*(TCRT-16.7949)+-9.7664                                                                                    
              YT = 0.5054*(TCRT-16.7949)**3+-0.4671*(TCRT-16.7949)**2+1.1404*(TCRT-16.7949)+25.1105                                                                                    
              ZT = 1.0987*(TCRT-16.7949)**3+-1.1224*(TCRT-16.7949)**2+2.3688*(TCRT-16.7949)+11.385                                                                                    
          ELSEIF (TCRT <= 17.6169) THEN                                             
              XW = -0.0211*(TCRT-17.2055)**3+0.2885*(TCRT-17.2055)**2+3.0658*(TCRT-17.2055)+-8.9331                                                                                    
              YW = -0.0345*(TCRT-17.2055)**3+-0.1287*(TCRT-17.2055)**2+1.1539*(TCRT-17.2055)+24.5023                                                                                    
              ZW = -0.024*(TCRT-17.2055)**3+-0.3461*(TCRT-17.2055)**2+2.1194*(TCRT-17.2055)+13.1191                                                                                    
              XF = XW+-0.0211*3*(TCRT-17.2055)**2+0.2885*2*(TCRT-17.2055)+3.0658                                                                                 
              YF = YW+-0.0345*3*(TCRT-17.2055)**2+-0.1287*2*(TCRT-17.2055)+1.1539                                                                                 
              ZF = ZW+-0.024*3*(TCRT-17.2055)**2+-0.3461*2*(TCRT-17.2055)+2.1194                                                                                 
              XT = -0.9413*(TCRT-17.2055)**3+0.9881*(TCRT-17.2055)**2+2.8694*(TCRT-17.2055)+-8.6646                                                                                    
              YT = -0.3705*(TCRT-17.2055)**3+0.1554*(TCRT-17.2055)**2+1.0124*(TCRT-17.2055)+25.5349                                                                                    
              ZT = -0.7152*(TCRT-17.2055)**3+0.2308*(TCRT-17.2055)**2+2.0027*(TCRT-17.2055)+12.2444                                                                                    
          ELSEIF (TCRT <= 18.0291) THEN                                             
              XW = -0.028*(TCRT-17.6169)**3+0.2624*(TCRT-17.6169)**2+3.2925*(TCRT-17.6169)+-7.6244                                                                                    
              YW = -0.0316*(TCRT-17.6169)**3+-0.1713*(TCRT-17.6169)**2+1.0304*(TCRT-17.6169)+24.9528                                                                                    
              ZW = -0.0247*(TCRT-17.6169)**3+-0.3757*(TCRT-17.6169)**2+1.8224*(TCRT-17.6169)+13.9308                                                                                    
              XF = XW+-0.028*3*(TCRT-17.6169)**2+0.2624*2*(TCRT-17.6169)+3.2925                                                                                 
              YF = YW+-0.0316*3*(TCRT-17.6169)**2+-0.1713*2*(TCRT-17.6169)+1.0304                                                                                 
              ZF = ZW+-0.0247*3*(TCRT-17.6169)**2+-0.3757*2*(TCRT-17.6169)+1.8224                                                                                 
              XT = 0.5091*(TCRT-17.6169)**3+-0.1737*(TCRT-17.6169)**2+3.2045*(TCRT-17.6169)+-7.3823                                                                                    
              YT = 0.148*(TCRT-17.6169)**3+-0.3019*(TCRT-17.6169)**2+0.9522*(TCRT-17.6169)+25.952                                                                                    
              ZT = 0.3215*(TCRT-17.6169)**3+-0.652*(TCRT-17.6169)**2+1.8295*(TCRT-17.6169)+13.0576                                                                                    
          ELSEIF (TCRT <= 18.4425) THEN                                             
              XW = -0.036*(TCRT-18.0291)**3+0.2278*(TCRT-18.0291)**2+3.4946*(TCRT-18.0291)+-6.2247                                                                                    
              YW = -0.0273*(TCRT-18.0291)**3+-0.2104*(TCRT-18.0291)**2+0.8731*(TCRT-18.0291)+25.3462                                                                                    
              ZW = -0.0234*(TCRT-18.0291)**3+-0.4062*(TCRT-18.0291)**2+1.5001*(TCRT-18.0291)+14.6164                                                                                    
              XF = XW+-0.036*3*(TCRT-18.0291)**2+0.2278*2*(TCRT-18.0291)+3.4946                                                                                 
              YF = YW+-0.0273*3*(TCRT-18.0291)**2+-0.2104*2*(TCRT-18.0291)+0.8731                                                                                 
              ZF = ZW+-0.0234*3*(TCRT-18.0291)**2+-0.4062*2*(TCRT-18.0291)+1.5001                                                                                 
              XT = -0.2492*(TCRT-18.0291)**3+0.4558*(TCRT-18.0291)**2+3.3207*(TCRT-18.0291)+-6.0554                                                                                    
              YT = -0.0963*(TCRT-18.0291)**3+-0.1189*(TCRT-18.0291)**2+0.7788*(TCRT-18.0291)+26.3035                                                                                    
              ZT = -0.1663*(TCRT-18.0291)**3+-0.2544*(TCRT-18.0291)**2+1.4559*(TCRT-18.0291)+13.7234                                                                                    
          ELSEIF (TCRT <= 18.853) THEN                                             
              XW = -0.0436*(TCRT-18.4425)**3+0.1832*(TCRT-18.4425)**2+3.6645*(TCRT-18.4425)+-4.7437                                                                                    
              YW = -0.0215*(TCRT-18.4425)**3+-0.2443*(TCRT-18.4425)**2+0.6852*(TCRT-18.4425)+25.6693                                                                                    
              ZW = -0.0194*(TCRT-18.4425)**3+-0.4352*(TCRT-18.4425)**2+1.1524*(TCRT-18.4425)+15.1655                                                                                    
              XF = XW+-0.0436*3*(TCRT-18.4425)**2+0.1832*2*(TCRT-18.4425)+3.6645                                                                                 
              YF = YW+-0.0215*3*(TCRT-18.4425)**2+-0.2443*2*(TCRT-18.4425)+0.6852                                                                                 
              ZF = ZW+-0.0194*3*(TCRT-18.4425)**2+-0.4352*2*(TCRT-18.4425)+1.1524                                                                                 
              XT = -0.004*(TCRT-18.4425)**3+0.1468*(TCRT-18.4425)**2+3.5698*(TCRT-18.4425)+-4.6225                                                                                    
              YT = -0.0045*(TCRT-18.4425)**3+-0.2383*(TCRT-18.4425)**2+0.6311*(TCRT-18.4425)+26.5983                                                                                    
              ZT = 0.0082*(TCRT-18.4425)**3+-0.4606*(TCRT-18.4425)**2+1.1603*(TCRT-18.4425)+14.27                                                                                    
          ELSEIF (TCRT <= 19.2683) THEN                                             
              XW = -0.0502*(TCRT-18.853)**3+0.1295*(TCRT-18.853)**2+3.7929*(TCRT-18.853)+-3.2115                                                                                    
              YW = -0.0138*(TCRT-18.853)**3+-0.2707*(TCRT-18.853)**2+0.4738*(TCRT-18.853)+25.9079                                                                                    
              ZW = -0.013*(TCRT-18.853)**3+-0.459*(TCRT-18.853)**2+0.7852*(TCRT-18.853)+15.5639                                                                                    
              XF = XW+-0.0502*3*(TCRT-18.853)**2+0.1295*2*(TCRT-18.853)+3.7929                                                                                 
              YF = YW+-0.0138*3*(TCRT-18.853)**2+-0.2707*2*(TCRT-18.853)+0.4738                                                                                 
              ZF = ZW+-0.013*3*(TCRT-18.853)**2+-0.459*2*(TCRT-18.853)+0.7852                                                                                 
              XT = -0.0537*(TCRT-18.853)**3+0.1419*(TCRT-18.853)**2+3.6883*(TCRT-18.853)+-3.1324                                                                                    
              YT = -0.0162*(TCRT-18.853)**3+-0.2438*(TCRT-18.853)**2+0.4332*(TCRT-18.853)+26.8169                                                                                    
              ZT = -0.0219*(TCRT-18.853)**3+-0.4505*(TCRT-18.853)**2+0.7863*(TCRT-18.853)+14.6693                                                                                    
          ELSEIF (TCRT <= 19.6838) THEN                                             
              XW = -0.0538*(TCRT-19.2683)**3+0.067*(TCRT-19.2683)**2+3.8745*(TCRT-19.2683)+-1.6177                                                                                    
              YW = -0.0048*(TCRT-19.2683)**3+-0.288*(TCRT-19.2683)**2+0.2418*(TCRT-19.2683)+26.057                                                                                    
              ZW = -0.0045*(TCRT-19.2683)**3+-0.4752*(TCRT-19.2683)**2+0.3973*(TCRT-19.2683)+15.8099                                                                                    
              XF = XW+-0.0538*3*(TCRT-19.2683)**2+0.067*2*(TCRT-19.2683)+3.8745                                                                                 
              YF = YW+-0.0048*3*(TCRT-19.2683)**2+-0.288*2*(TCRT-19.2683)+0.2418                                                                                 
              ZF = ZW+-0.0045*3*(TCRT-19.2683)**2+-0.4752*2*(TCRT-19.2683)+0.3973                                                                                 
              XT = -0.0395*(TCRT-19.2683)**3+0.075*(TCRT-19.2683)**2+3.7784*(TCRT-19.2683)+-1.5802                                                                                    
              YT = -0.0062*(TCRT-19.2683)**3+-0.264*(TCRT-19.2683)**2+0.2223*(TCRT-19.2683)+26.9536                                                                                    
              ZT = -0.0082*(TCRT-19.2683)**3+-0.4777*(TCRT-19.2683)**2+0.4008*(TCRT-19.2683)+14.9165                                                                                    
          ELSEIF (TCRT <= 20.098) THEN                                             
              XW = -0.0537*(TCRT-19.6838)**3+0.0*(TCRT-19.6838)**2+3.9023*(TCRT-19.6838)+0.0                                                                                    
              YW = 0.0047*(TCRT-19.6838)**3+-0.2939*(TCRT-19.6838)**2+0.0*(TCRT-19.6838)+26.1074                                                                                    
              ZW = 0.0045*(TCRT-19.6838)**3+-0.4808*(TCRT-19.6838)**2+0.0*(TCRT-19.6838)+15.8926                                                                                    
              XF = XW+-0.0537*3*(TCRT-19.6838)**2+0.0*2*(TCRT-19.6838)+3.9023                                                                                 
              YF = YW+0.0047*3*(TCRT-19.6838)**2+-0.2939*2*(TCRT-19.6838)+0.0                                                                                 
              ZF = ZW+0.0045*3*(TCRT-19.6838)**2+-0.4808*2*(TCRT-19.6838)+0.0                                                                                 
              XT = -0.1148*(TCRT-19.6838)**3+0.0258*(TCRT-19.6838)**2+3.8203*(TCRT-19.6838)+0.0                                                                                    
              YT = 0.0065*(TCRT-19.6838)**3+-0.2717*(TCRT-19.6838)**2+-0.0003*(TCRT-19.6838)+27.0                                                                                    
              ZT = 0.0087*(TCRT-19.6838)**3+-0.488*(TCRT-19.6838)**2+-0.0005*(TCRT-19.6838)+15.0                                                                                    
          ELSEIF (TCRT <= 20.5146) THEN                                             
              XW = -0.0502*(TCRT-20.098)**3+-0.0667*(TCRT-20.098)**2+3.8746*(TCRT-20.098)+1.6127                                                                                    
              YW = 0.0138*(TCRT-20.098)**3+-0.288*(TCRT-20.098)**2+-0.2411*(TCRT-20.098)+26.0573                                                                                    
              ZW = 0.0129*(TCRT-20.098)**3+-0.4752*(TCRT-20.098)**2+-0.3961*(TCRT-20.098)+15.8104                                                                                    
              XF = XW+-0.0502*3*(TCRT-20.098)**2+-0.0667*2*(TCRT-20.098)+3.8746                                                                                 
              YF = YW+0.0138*3*(TCRT-20.098)**2+-0.288*2*(TCRT-20.098)+-0.2411                                                                                 
              ZF = ZW+0.0129*3*(TCRT-20.098)**2+-0.4752*2*(TCRT-20.098)+-0.3961                                                                                 
              XT = -0.0487*(TCRT-20.098)**3+-0.1168*(TCRT-20.098)**2+3.7826*(TCRT-20.098)+1.5788                                                                                    
              YT = 0.0234*(TCRT-20.098)**3+-0.2637*(TCRT-20.098)**2+-0.2221*(TCRT-20.098)+26.9537                                                                                    
              ZT = 0.0348*(TCRT-20.098)**3+-0.4772*(TCRT-20.098)**2+-0.4003*(TCRT-20.098)+14.9167                                                                                    
          ELSEIF (TCRT <= 20.9288) THEN                                             
              XW = -0.0437*(TCRT-20.5146)**3+-0.1295*(TCRT-20.5146)**2+3.7929*(TCRT-20.5146)+3.2116                                                                                    
              YW = 0.0215*(TCRT-20.5146)**3+-0.2707*(TCRT-20.5146)**2+-0.4738*(TCRT-20.5146)+25.9079                                                                                    
              ZW = 0.0195*(TCRT-20.5146)**3+-0.4591*(TCRT-20.5146)**2+-0.7853*(TCRT-20.5146)+15.5639                                                                                    
              XF = XW+-0.0437*3*(TCRT-20.5146)**2+-0.1295*2*(TCRT-20.5146)+3.7929                                                                                 
              YF = YW+0.0215*3*(TCRT-20.5146)**2+-0.2707*2*(TCRT-20.5146)+-0.4738                                                                                 
              ZF = ZW+0.0195*3*(TCRT-20.5146)**2+-0.4591*2*(TCRT-20.5146)+-0.7853                                                                                 
              XT = 0.0972*(TCRT-20.5146)**3+-0.1776*(TCRT-20.5146)**2+3.6599*(TCRT-20.5146)+3.1308                                                                                    
              YT = -0.0111*(TCRT-20.5146)**3+-0.2345*(TCRT-20.5146)**2+-0.4296*(TCRT-20.5146)+26.8171                                                                                    
              ZT = -0.0349*(TCRT-20.5146)**3+-0.4337*(TCRT-20.5146)**2+-0.7797*(TCRT-20.5146)+14.6696                                                                                    
          ELSEIF (TCRT <= 21.3385) THEN                                             
              XW = -0.0358*(TCRT-20.9288)**3+-0.1838*(TCRT-20.9288)**2+3.6631*(TCRT-20.9288)+4.7572                                                                                    
              YW = 0.0274*(TCRT-20.9288)**3+-0.244*(TCRT-20.9288)**2+-0.687*(TCRT-20.9288)+25.6667                                                                                    
              ZW = 0.0233*(TCRT-20.9288)**3+-0.4348*(TCRT-20.9288)**2+-1.1555*(TCRT-20.9288)+15.1612                                                                                    
              XF = XW+-0.0358*3*(TCRT-20.9288)**2+-0.1838*2*(TCRT-20.9288)+3.6631                                                                                 
              YF = YW+0.0274*3*(TCRT-20.9288)**2+-0.244*2*(TCRT-20.9288)+-0.687                                                                                 
              ZF = ZW+0.0233*3*(TCRT-20.9288)**2+-0.4348*2*(TCRT-20.9288)+-1.1555                                                                                 
              XT = -0.2355*(TCRT-20.9288)**3+-0.0569*(TCRT-20.9288)**2+3.5627*(TCRT-20.9288)+4.6231                                                                                    
              YT = 0.0656*(TCRT-20.9288)**3+-0.2482*(TCRT-20.9288)**2+-0.6295*(TCRT-20.9288)+26.5982                                                                                    
              ZT = 0.1018*(TCRT-20.9288)**3+-0.4771*(TCRT-20.9288)**2+-1.157*(TCRT-20.9288)+14.2698                                                                                    
          ELSEIF (TCRT <= 21.7507) THEN                                             
              XW = -0.0281*(TCRT-21.3385)**3+-0.2277*(TCRT-21.3385)**2+3.4945*(TCRT-21.3385)+6.2247                                                                                    
              YW = 0.0316*(TCRT-21.3385)**3+-0.2103*(TCRT-21.3385)**2+-0.8731*(TCRT-21.3385)+25.3462                                                                                    
              ZW = 0.0248*(TCRT-21.3385)**3+-0.4063*(TCRT-21.3385)**2+-1.5001*(TCRT-21.3385)+14.6164                                                                                    
              XF = XW+-0.0281*3*(TCRT-21.3385)**2+-0.2277*2*(TCRT-21.3385)+3.4945                                                                                 
              YF = YW+0.0316*3*(TCRT-21.3385)**2+-0.2103*2*(TCRT-21.3385)+-0.8731                                                                                 
              ZF = ZW+0.0248*3*(TCRT-21.3385)**2+-0.4063*2*(TCRT-21.3385)+-1.5001                                                                                 
              XT = 0.104*(TCRT-21.3385)**3+-0.3464*(TCRT-21.3385)**2+3.3975*(TCRT-21.3385)+6.057                                                                                    
              YT = 0.001*(TCRT-21.3385)**3+-0.1676*(TCRT-21.3385)**2+-0.7999*(TCRT-21.3385)+26.3032                                                                                    
              ZT = -0.0248*(TCRT-21.3385)**3+-0.352*(TCRT-21.3385)**2+-1.4966*(TCRT-21.3385)+13.7227                                                                                    
          ELSEIF (TCRT <= 22.162) THEN                                             
              XW = -0.0211*(TCRT-21.7507)**3+-0.2624*(TCRT-21.7507)**2+3.2925*(TCRT-21.7507)+7.6243                                                                                    
              YW = 0.0346*(TCRT-21.7507)**3+-0.1713*(TCRT-21.7507)**2+-1.0304*(TCRT-21.7507)+24.9528                                                                                    
              ZW = 0.0239*(TCRT-21.7507)**3+-0.3756*(TCRT-21.7507)**2+-1.8224*(TCRT-21.7507)+13.9309                                                                                    
              XF = XW+-0.0211*3*(TCRT-21.7507)**2+-0.2624*2*(TCRT-21.7507)+3.2925                                                                                 
              YF = YW+0.0346*3*(TCRT-21.7507)**2+-0.1713*2*(TCRT-21.7507)+-1.0304                                                                                 
              ZF = ZW+0.0239*3*(TCRT-21.7507)**2+-0.3756*2*(TCRT-21.7507)+-1.8224                                                                                 
              XT = -0.0859*(TCRT-21.7507)**3+-0.2177*(TCRT-21.7507)**2+3.165*(TCRT-21.7507)+7.4057                                                                                    
              YT = 0.0516*(TCRT-21.7507)**3+-0.1664*(TCRT-21.7507)**2+-0.9376*(TCRT-21.7507)+25.9451                                                                                    
              ZT = 0.0685*(TCRT-21.7507)**3+-0.3826*(TCRT-21.7507)**2+-1.7994*(TCRT-21.7507)+13.0444                                                                                    
          ELSEIF (TCRT <= 22.5726) THEN                                             
              XW = -0.0159*(TCRT-22.162)**3+-0.2885*(TCRT-22.162)**2+3.0659*(TCRT-22.162)+8.9327                                                                                    
              YW = 0.0368*(TCRT-22.162)**3+-0.1287*(TCRT-22.162)**2+-1.1538*(TCRT-22.162)+24.5024                                                                                    
              ZW = 0.0218*(TCRT-22.162)**3+-0.3461*(TCRT-22.162)**2+-2.1193*(TCRT-22.162)+13.1194                                                                                    
              XF = XW+-0.0159*3*(TCRT-22.162)**2+-0.2885*2*(TCRT-22.162)+3.0659                                                                                 
              YF = YW+0.0368*3*(TCRT-22.162)**2+-0.1287*2*(TCRT-22.162)+-1.1538                                                                                 
              ZF = ZW+0.0218*3*(TCRT-22.162)**2+-0.3461*2*(TCRT-22.162)+-2.1193                                                                                 
              XT = 0.0594*(TCRT-22.162)**3+-0.3237*(TCRT-22.162)**2+2.9423*(TCRT-22.162)+8.6647                                                                                    
              YT = 0.0*(TCRT-22.162)**3+-0.1027*(TCRT-22.162)**2+-1.0482*(TCRT-22.162)+25.5349                                                                                    
              ZT = -0.0508*(TCRT-22.162)**3+-0.2981*(TCRT-22.162)**2+-2.0794*(TCRT-22.162)+12.2443                                                                                    
          ELSEIF (TCRT <= 22.9824) THEN                                             
              XW = -0.0127*(TCRT-22.5726)**3+-0.3081*(TCRT-22.5726)**2+2.8209*(TCRT-22.5726)+10.1418                                                                                    
              YW = 0.0392*(TCRT-22.5726)**3+-0.0833*(TCRT-22.5726)**2+-1.2409*(TCRT-22.5726)+24.0095                                                                                    
              ZW = 0.0189*(TCRT-22.5726)**3+-0.3193*(TCRT-22.5726)**2+-2.3925*(TCRT-22.5726)+12.1924                                                                                    
              XF = XW+-0.0127*3*(TCRT-22.5726)**2+-0.3081*2*(TCRT-22.5726)+2.8209                                                                                 
              YF = YW+0.0392*3*(TCRT-22.5726)**2+-0.0833*2*(TCRT-22.5726)+-1.2409                                                                                 
              ZF = ZW+0.0189*3*(TCRT-22.5726)**2+-0.3193*2*(TCRT-22.5726)+-2.3925                                                                                 
              XT = -0.2381*(TCRT-22.5726)**3+-0.2506*(TCRT-22.5726)**2+2.7065*(TCRT-22.5726)+9.8224                                                                                    
              YT = 0.1539*(TCRT-22.5726)**3+-0.1027*(TCRT-22.5726)**2+-1.1326*(TCRT-22.5726)+25.0872                                                                                    
              ZT = 0.2929*(TCRT-22.5726)**3+-0.3607*(TCRT-22.5726)**2+-2.3499*(TCRT-22.5726)+11.3367                                                                                    
          ELSEIF (TCRT <= 23.3913) THEN                                             
              XW = -0.0114*(TCRT-22.9824)**3+-0.3238*(TCRT-22.9824)**2+2.562*(TCRT-22.9824)+11.2452                                                                                    
              YW = 0.042*(TCRT-22.9824)**3+-0.0352*(TCRT-22.9824)**2+-1.2895*(TCRT-22.9824)+23.4897                                                                                    
              ZW = 0.0162*(TCRT-22.9824)**3+-0.2961*(TCRT-22.9824)**2+-2.6447*(TCRT-22.9824)+11.1596                                                                                    
              XF = XW+-0.0114*3*(TCRT-22.9824)**2+-0.3238*2*(TCRT-22.9824)+2.562                                                                                 
              YF = YW+0.042*3*(TCRT-22.9824)**2+-0.0352*2*(TCRT-22.9824)+-1.2895                                                                                 
              ZF = ZW+0.0162*3*(TCRT-22.9824)**2+-0.2961*2*(TCRT-22.9824)+-2.6447                                                                                 
              XT = 0.3118*(TCRT-22.9824)**3+-0.5433*(TCRT-22.9824)**2+2.3811*(TCRT-22.9824)+10.873                                                                                    
              YT = -0.1197*(TCRT-22.9824)**3+0.0866*(TCRT-22.9824)**2+-1.1392*(TCRT-22.9824)+24.6164                                                                                    
              ZT = -0.323*(TCRT-22.9824)**3+-0.0006*(TCRT-22.9824)**2+-2.4979*(TCRT-22.9824)+10.3333                                                                                    
          ELSEIF (TCRT <= 23.7995) THEN                                             
              XW = -0.012*(TCRT-23.3913)**3+-0.3378*(TCRT-23.3913)**2+2.2915*(TCRT-23.3913)+12.2379                                                                                    
              YW = 0.0457*(TCRT-23.3913)**3+0.0163*(TCRT-23.3913)**2+-1.2972*(TCRT-23.3913)+22.9594                                                                                    
              ZW = 0.0145*(TCRT-23.3913)**3+-0.2763*(TCRT-23.3913)**2+-2.8788*(TCRT-23.3913)+10.0297                                                                                    
              XF = XW+-0.012*3*(TCRT-23.3913)**2+-0.3378*2*(TCRT-23.3913)+2.2915                                                                                 
              YF = YW+0.0457*3*(TCRT-23.3913)**2+0.0163*2*(TCRT-23.3913)+-1.2972                                                                                 
              ZF = ZW+0.0145*3*(TCRT-23.3913)**2+-0.2763*2*(TCRT-23.3913)+-2.8788                                                                                 
              XT = -0.1539*(TCRT-23.3913)**3+-0.1608*(TCRT-23.3913)**2+2.0932*(TCRT-23.3913)+11.7772                                                                                    
              YT = 0.1046*(TCRT-23.3913)**3+-0.0603*(TCRT-23.3913)**2+-1.1284*(TCRT-23.3913)+24.1568                                                                                    
              ZT = 0.1469*(TCRT-23.3913)**3+-0.3969*(TCRT-23.3913)**2+-2.6605*(TCRT-23.3913)+9.2897                                                                                    
          ELSEIF (TCRT <= 24.207) THEN                                             
              XW = -0.0138*(TCRT-23.7995)**3+-0.3524*(TCRT-23.7995)**2+2.0098*(TCRT-23.7995)+13.1161                                                                                    
              YW = 0.0501*(TCRT-23.7995)**3+0.0723*(TCRT-23.7995)**2+-1.261*(TCRT-23.7995)+22.4358                                                                                    
              ZW = 0.0147*(TCRT-23.7995)**3+-0.2585*(TCRT-23.7995)**2+-3.097*(TCRT-23.7995)+8.8097                                                                                    
              XF = XW+-0.0138*3*(TCRT-23.7995)**2+-0.3524*2*(TCRT-23.7995)+2.0098                                                                                 
              YF = YW+0.0501*3*(TCRT-23.7995)**2+0.0723*2*(TCRT-23.7995)+-1.261                                                                                 
              ZF = ZW+0.0147*3*(TCRT-23.7995)**2+-0.2585*2*(TCRT-23.7995)+-3.097                                                                                 
              XT = -0.0173*(TCRT-23.7995)**3+-0.3493*(TCRT-23.7995)**2+1.885*(TCRT-23.7995)+12.5943                                                                                    
              YT = 0.0552*(TCRT-23.7995)**3+0.0678*(TCRT-23.7995)**2+-1.1254*(TCRT-23.7995)+23.6933                                                                                    
              ZT = 0.0678*(TCRT-23.7995)**3+-0.217*(TCRT-23.7995)**2+-2.911*(TCRT-23.7995)+8.1477                                                                                    
          ELSEIF (TCRT <= 24.6188) THEN                                             
              XW = -0.0166*(TCRT-24.207)**3+-0.3692*(TCRT-24.207)**2+1.7156*(TCRT-24.207)+13.8758                                                                                    
              YW = 0.0544*(TCRT-24.207)**3+0.1335*(TCRT-24.207)**2+-1.1771*(TCRT-24.207)+21.9372                                                                                    
              ZW = 0.0185*(TCRT-24.207)**3+-0.2406*(TCRT-24.207)**2+-3.3005*(TCRT-24.207)+7.5055                                                                                    
              XF = XW+-0.0166*3*(TCRT-24.207)**2+-0.3692*2*(TCRT-24.207)+1.7156                                                                                 
              YF = YW+0.0544*3*(TCRT-24.207)**2+0.1335*2*(TCRT-24.207)+-1.1771                                                                                 
              ZF = ZW+0.0185*3*(TCRT-24.207)**2+-0.2406*2*(TCRT-24.207)+-3.3005                                                                                 
              XT = 0.0337*(TCRT-24.207)**3+-0.3705*(TCRT-24.207)**2+1.5916*(TCRT-24.207)+13.3033                                                                                    
              YT = 0.0132*(TCRT-24.207)**3+0.1353*(TCRT-24.207)**2+-1.0426*(TCRT-24.207)+23.2497                                                                                    
              ZT = -0.0969*(TCRT-24.207)**3+-0.1341*(TCRT-24.207)**2+-3.0541*(TCRT-24.207)+6.9298                                                                                    
          ELSEIF (TCRT <= 25.0248) THEN                                             
              XW = -0.0186*(TCRT-24.6188)**3+-0.3897*(TCRT-24.6188)**2+1.4031*(TCRT-24.6188)+14.5184                                                                                    
              YW = 0.0557*(TCRT-24.6188)**3+0.2008*(TCRT-24.6188)**2+-1.0394*(TCRT-24.6188)+21.479                                                                                    
              ZW = 0.0264*(TCRT-24.6188)**3+-0.2177*(TCRT-24.6188)**2+-3.4892*(TCRT-24.6188)+6.107                                                                                    
              XF = XW+-0.0186*3*(TCRT-24.6188)**2+-0.3897*2*(TCRT-24.6188)+1.4031                                                                                 
              YF = YW+0.0557*3*(TCRT-24.6188)**2+0.2008*2*(TCRT-24.6188)+-1.0394                                                                                 
              ZF = ZW+0.0264*3*(TCRT-24.6188)**2+-0.2177*2*(TCRT-24.6188)+-3.4892                                                                                 
              XT = -0.0508*(TCRT-24.6188)**3+-0.3289*(TCRT-24.6188)**2+1.3036*(TCRT-24.6188)+13.8982                                                                                    
              YT = 0.0735*(TCRT-24.6188)**3+0.1516*(TCRT-24.6188)**2+-0.9245*(TCRT-24.6188)+22.8442                                                                                    
              ZT = 0.0902*(TCRT-24.6188)**3+-0.2538*(TCRT-24.6188)**2+-3.2138*(TCRT-24.6188)+5.6428                                                                                    
          ELSEIF (TCRT <= 25.431) THEN                                             
              XW = -0.0192*(TCRT-25.0248)**3+-0.4123*(TCRT-25.0248)**2+1.0775*(TCRT-25.0248)+15.0226                                                                                    
              YW = 0.0532*(TCRT-25.0248)**3+0.2686*(TCRT-25.0248)**2+-0.8489*(TCRT-25.0248)+21.0938                                                                                    
              ZW = 0.0379*(TCRT-25.0248)**3+-0.1856*(TCRT-25.0248)**2+-3.6529*(TCRT-25.0248)+4.6562                                                                                    
              XF = XW+-0.0192*3*(TCRT-25.0248)**2+-0.4123*2*(TCRT-25.0248)+1.0775                                                                                 
              YF = YW+0.0532*3*(TCRT-25.0248)**2+0.2686*2*(TCRT-25.0248)+-0.8489                                                                                 
              ZF = ZW+0.0379*3*(TCRT-25.0248)**2+-0.1856*2*(TCRT-25.0248)+-3.6529                                                                                 
              XT = -0.0095*(TCRT-25.0248)**3+-0.3908*(TCRT-25.0248)**2+1.0114*(TCRT-25.0248)+14.3698                                                                                    
              YT = 0.0438*(TCRT-25.0248)**3+0.2412*(TCRT-25.0248)**2+-0.765*(TCRT-25.0248)+22.4988                                                                                    
              ZT = 0.0027*(TCRT-25.0248)**3+-0.1439*(TCRT-25.0248)**2+-3.3752*(TCRT-25.0248)+4.3022                                                                                    
          ELSEIF (TCRT <= 25.8378) THEN                                             
              XW = -0.0126*(TCRT-25.431)**3+-0.4358*(TCRT-25.431)**2+0.733*(TCRT-25.431)+15.391                                                                                    
              YW = 0.033*(TCRT-25.431)**3+0.3335*(TCRT-25.431)**2+-0.6043*(TCRT-25.431)+20.7969                                                                                    
              ZW = 0.0541*(TCRT-25.431)**3+-0.1394*(TCRT-25.431)**2+-3.7849*(TCRT-25.431)+3.1443                                                                                    
              XF = XW+-0.0126*3*(TCRT-25.431)**2+-0.4358*2*(TCRT-25.431)+0.733                                                                                 
              YF = YW+0.033*3*(TCRT-25.431)**2+0.3335*2*(TCRT-25.431)+-0.6043                                                                                 
              ZF = ZW+0.0541*3*(TCRT-25.431)**2+-0.1394*2*(TCRT-25.431)+-3.7849                                                                                 
              XT = -0.0182*(TCRT-25.431)**3+-0.4024*(TCRT-25.431)**2+0.6891*(TCRT-25.431)+14.7155                                                                                    
              YT = 0.0364*(TCRT-25.431)**3+0.2945*(TCRT-25.431)**2+-0.5474*(TCRT-25.431)+22.2308                                                                                    
              ZT = 0.0508*(TCRT-25.431)**3+-0.1406*(TCRT-25.431)**2+-3.4908*(TCRT-25.431)+2.9075                                                                                    
          ELSEIF (TCRT <= 26.2451) THEN                                             
              XW = -0.0126*(TCRT-25.8378)**3+-0.4512*(TCRT-25.8378)**2+0.3721*(TCRT-25.8378)+15.6162                                                                                    
              YW = 0.033*(TCRT-25.8378)**3+0.3738*(TCRT-25.8378)**2+-0.3166*(TCRT-25.8378)+20.6084                                                                                    
              ZW = 0.0541*(TCRT-25.8378)**3+-0.0733*(TCRT-25.8378)**2+-3.8714*(TCRT-25.8378)+1.5851                                                                                    
              XF = XW+-0.0126*3*(TCRT-25.8378)**2+-0.4512*2*(TCRT-25.8378)+0.3721                                                                                 
              YF = YW+0.033*3*(TCRT-25.8378)**2+0.3738*2*(TCRT-25.8378)+-0.3166                                                                                 
              ZF = ZW+0.0541*3*(TCRT-25.8378)**2+-0.0733*2*(TCRT-25.8378)+-3.8714                                                                                 
              XT = -0.0182*(TCRT-25.8378)**3+-0.4246*(TCRT-25.8378)**2+0.3527*(TCRT-25.8378)+14.928                                                                                    
              YT = 0.0364*(TCRT-25.8378)**3+0.339*(TCRT-25.8378)**2+-0.2897*(TCRT-25.8378)+22.0593                                                                                    
              ZT = 0.0508*(TCRT-25.8378)**3+-0.0787*(TCRT-25.8378)**2+-3.58*(TCRT-25.8378)+1.4675                                                                                    
          END IF                                                                                                            
                                                                                                                            
          P1 = [XW, YW, ZW]                                                                                                 
          P2 = [XF, YF, ZF]                                                                                                 
          P3 = [XT, YT, ZT]                                                                                                 
                                                                                                                            
C  计算热源                                                                                                                
          PA = COORDS                                                                                                      
          DIS = DISTANCE(P1, P2, P3, PA)                                                                                   
          xx = DIS(1)**2                                                                                                   
          yy = DIS(2)**2                                                                                                   
          zz = DIS(3)**2                                                                                                   
          IF (DIS(1) .GE. 0.0) THEN                                                                                        
              FLUX(1) = qm1*EXP(-3*(xx/a1**2 + yy/b**2 + zz/c**2))                                                         
          ELSE                                                                                                             
              FLUX(1) = qm2*EXP(-3*(xx/a2**2 + yy/b**2 + zz/c**2))                                                         
          END IF                                                                                                           
C  ========================第1条焊缝结束============================                                        
      ELSE                                                                                                               
          FLUX(1) = 0.0                                                                                                  
      END IF                                                                                                             
                                                                                                                         
      RETURN                                                                                                             
      END                                                                                                                
